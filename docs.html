<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Documentation</title>
    <link rel="stylesheet" href="css/site.css">
  </head>
  <body>
    <div class="maincontainer">
      <header>
          JS Cause
      </header>
      
      <div class="topmenu">
        <ul>
    
      
        <li><a href="index.html">Main</a></li>
      
    
      
        <li><a href="features.html">Features</a></li>
      
    
      
        <li><a href="download.html">Download</a></li>
      
    
      
        <li><a href="install.html">Installation</a></li>
      
    
      
        <li><a href="tutorial.html">Tutorial</a></li>
      
    
      
        <li>Documentation</li>
      
    
      
        <li><a href="faq.html">Frequently Asked Questions</a></li>
      
    
      
        <li><a href="about.html">About</a></li>
      
    
</ul>

      </div>
      
      <div class="title">
          <h1>Documentation</h1>
      </div>
      <div class="content">
          <p>(TO-DO: Address all the TO-DO’s before publishing)</p>

<p>(TO-DO:And put an index here?)</p>

<h2 id="what-is-jscause">What is JSCause?</h2>

<p>JSCause is a web framework and engine built on top of NodeJS which can be used to create simple websites.  Or complex ones, if you so desire.</p>

<p>JSCause can serve HTML, CSS and JS files for a browser to render, just like a regular HTTP server such as Apache or nginx.  It can also preprocess files on the server side, much like how ASP Classic and PHP do.</p>

<p>For example, in ASP Classic, you can have an <code class="highlighter-rouge">index.asp</code> file which, among other things, could contain the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;h1&gt;Hello from ASP&lt;/h1&gt;
&lt;p&gt;&lt;% Response.Write("Hello, World") %&gt;&lt;/p&gt;
</code></pre></div></div>

<p>In PHP, that would be an <code class="highlighter-rouge">index.php</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;h1&gt;Hello from PHP&lt;/h1&gt;
&lt;p&gt;&lt;?php echo 'Hello, World'; ?&gt;&lt;/p&gt;
</code></pre></div></div>

<p>In JSCause, it would be <code class="highlighter-rouge">index.jscp</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;h1&gt;Hello from JSCause&lt;/h1&gt;
&lt;p&gt;&lt;js rt.print('Hello, World'); /js&gt;&lt;/p&gt;
</code></pre></div></div>

<p>The <code class="highlighter-rouge">jscp</code> extension stands for “[J]ava[S]cript [C]ompiled [P]age.”</p>

<h2 id="structure-of-a-jscause-site">Structure of a JSCause site</h2>

<p>A typical JSCause installation will have the following file and directory structure:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./jscause.js
 ./jscause.conf
 ./jscvendor/
 ./logs/
 ./sites/mysite/
 ./sites/mysite/configuration/site.json
 ./sites/mysite/configuration/certs/
 ./sites/mysite/logs/
 ./sites/mysite/website/
</code></pre></div></div>

<h3 id="the-interesting-stuff">The interesting stuff</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">sites/mysite</code>: This subdirectory contains your site’s actual content, configuration and logs.  It can be renamed in <code class="highlighter-rouge">jscause.conf</code> (read below.)</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sites/mysite/website/</code>:  This subdirectory will contain your website’s files and resources to be served to the browser and other web clients:  All your HTML, CSS and Javascript files go in here.  Other assets go here as well; such as images and files to be downloaded.  Dynamic <code class="highlighter-rouge">.jscp</code> files also go here.  These will be parsed and executed by JSCause, and the result of said execution will be sent to the web client.  <a href="#the-website-directory-all-your-websites-content">Read more about this directory here</a>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sites/mysite/configuration/site.json</code>: In this file you can configure the details of your website: host name and port, upload limits, logging, etc. <a href="#sitejson-configuring-your-websites-details">Read more about this file in the site.json section</a>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sites/mysite/configuration/certs</code>: If you site uses a secure connection (HTTPS), you will have to place your certificate files in this location.  More information in <a href="#httpsssl-configuration">the HTTPS/SSL configuration section</a>, as well as in <a href="#sitejson-configuring-your-websites-details">the site.json section</a>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sites/mysite/logs/</code>:  In this subdirectory, JSCause will log access and error entries pertaining to your website.</p>
  </li>
</ul>

<h3 id="the-important-to-know-stuff">The important to know stuff</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">jscause.conf</code>: This file holds JSCause’s general configuration.  You can specify here where your content and log files are, whether to accept secure HTTPS connections, etc.  It may also hold configuration options that apply to, and prevail over, a website’s <code class="highlighter-rouge">site.json</code> configuration.  You can <a href="#jscauseconf-configuring-jscause-to-serve-your-website">read more about this file here</a>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">logs/</code>: This directory contains the server access and error logs.</p>
  </li>
</ul>

<h3 id="the-boilerplate-stuff">The boilerplate stuff</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">jscause.js</code>: This file contains the actual JSCause node application.  You use it when running node to start serving your website (<code class="highlighter-rouge">node jscause.js</code>). You won’t normally need to edit this file, ever.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">jscvendor/</code>:  This directory contains the third-party dependencies that support specific JSCause features, such as HTML form handling and cookies.  You won’t normally need to edit the contents of this directory.  “But I thought JSCause didn’t have any dependencies!” you may be thinking.  What we mean by that is that JSCause is self-contained.  Once you download and unzip it, it’s good to go.  <a href="#jscvendor-jscause-vendor-directory">Read more about the jscvendor directory here</a>.</p>
  </li>
</ul>

<h2 id="jscauseconf-configuring-jscause-to-serve-your-website">jscause.conf: Configuring JSCause to serve your website</h2>

<p>When JSCause is invoked, it reads the <code class="highlighter-rouge">jscause.conf</code> file for configuration options. The options are declared as a <em>sort of</em> JSON object.  We use “sort of” here because comments (designated by <code class="highlighter-rouge">//</code>) are allowed, whereas in a truly JSON object, they are not.</p>

<p>The options, in the form of attributes, are case insensitive (i.e. <code class="highlighter-rouge">sites</code> can be written as <code class="highlighter-rouge">Sites</code>, <code class="highlighter-rouge">SITES</code>, <code class="highlighter-rouge">sItEs</code>, etc.)  They are listed below:</p>

<h3 id="sites">sites:</h3>

<p>This is an array of object declarations, each representing a site to be served by JSCause:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"sites": [
  {
    // First site configuration goes here.
  },
  {
    // Second site configuration goes here.
  }
  // etc.
]
</code></pre></div></div>

<p>A site entry can contain the following attributes:</p>

<p><strong><em>name</em></strong></p>

<p>This is the site’s name.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"name": "My Site"
</code></pre></div></div>

<p>“<em>name</em>” must be unique.  If JSCause ever needs to notify or log some event related to the site, it will refer to it by this name.</p>

<p><strong><em>port</em></strong></p>

<p>This is the network port JSCause will listen for client connections.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"port": 3000
</code></pre></div></div>

<p>More than one site can share the same port, as long as they also have a unique host name (read <a href="#sitejson-configuring-your-websites-details">the site.json section</a>) and a unique root directory name (read the next section about <code class="highlighter-rouge">rootDirectoryName</code>.)</p>

<p><strong><em>rootDirectoryName</em></strong></p>

<p>This is the name of the subdirectory the website files are located at inside the <code class="highlighter-rouge">sites/</code> directory.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"rootDirectoryName": "mysite"
</code></pre></div></div>

<p>The above states that the site is under <code class="highlighter-rouge">sites/mysite</code>.</p>

<p>More than one site can share the same root directory name, as long as they use different ports.</p>

<p><strong><em>enableHTTPS</em></strong></p>

<p>This attribute indicates whether the site is served as either HTTPS (<code class="highlighter-rouge">true</code>) or HTTP (<code class="highlighter-rouge">false</code>).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"enableHTTPS": true
</code></pre></div></div>

<p>If HTTPS is enabled, you must provide JSCause with your certificate file, as well as your certificate’s public key file.  Check out these resources: <a href="#sitejson-configuring-your-websites-details">httpsCertFile and httpsKeyFile section on site.json</a>, and the <a href="#httpsssl-configuration">HTTPS/SSL configuration section</a>.</p>

<h3 id="logging">logging:</h3>

<p>This is a list of attributes to indicate what JSCause will log, and how:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"logging": {
  "general": {
    // Attributes pertaining application-wide logging.
  },
  "perSite": {
    // Attributes pertaining per-site-wide logging.
  }
}
</code></pre></div></div>

<p>This attribute is optional.  However, if you omit it, some options will be assumed as default.  For example, console output will be enabled, and file output will be enabled server-wide; <code class="highlighter-rouge">./logs</code> will be assumed as the logging directory as well, so make sure it exists.</p>

<p>To learn more about what type of data JSCause logs, please check out the <a href="#logging-features">Logging Features</a> section.</p>

<p><strong><em>general</em></strong></p>

<p>A “<em>general</em>” entry can contain the following attributes:</p>

<p><strong>- fileOutput</strong></p>

<p>This attribute indicates whether the log data should be written to the file system.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"fileOutput": "enabled"
</code></pre></div></div>

<p>There are two valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Create log files and write to them.  You must provide a valid <code class="highlighter-rouge">directoryName</code> entry (read below.)</li>
  <li><code class="highlighter-rouge">disabled</code>:  No creating log files or writing to them.  In this case, <code class="highlighter-rouge">directoryName</code> can be optional.</li>
</ul>

<p>Log files have the following file name format: <code class="highlighter-rouge">jsc_YYYY-MM-DD_HH-00-00.log</code>.  For example:  <code class="highlighter-rouge">jsc_2020-02-08_22-00-00.log</code> indicates a log file for Feb 08, 2020, at 10pm.  When the hour changes (in our example, from 10pm to 11pm), a new log file is created (in our case, <code class="highlighter-rouge">jsc_2020-02-08_23-00-00.log</code>)</p>

<p><strong>- directoryName</strong></p>

<p>This is the path of the directory to be used to store JSCause’s log data.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"directoryName": "./logs"
</code></pre></div></div>

<p>The path can be absolute (e.g. <code class="highlighter-rouge">/home/user_name/server_data/logs</code>) or relative (e.g. <code class="highlighter-rouge">./logs</code>).  If relative, it will be relative to the directory where JSCause is installed.</p>

<p>A missing or empty <code class="highlighter-rouge">directoryName</code> will be assumed <code class="highlighter-rouge">./logs</code>. Regardless of whether <code class="highlighter-rouge">fileOutput</code> is true or false, <code class="highlighter-rouge">directoryName</code> must point to an existing directory.</p>

<p><strong>- consoleOutput</strong></p>

<p>This attribute indicates whether the log data should be printed to the terminal.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"consoleOutput": "enabled"
</code></pre></div></div>

<p>There are two valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Print to the terminal.</li>
  <li><code class="highlighter-rouge">disabled</code>:  No printing to the terminal whatsoever.</li>
</ul>

<p><strong>- logFileSizeThreshold</strong></p>

<p>This attribute indicates the maximum size in bytes the log file can reach before being compressed and archived away.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"logFileSizeThreshold": 131072 // 128 * 1024 = 128 KB
</code></pre></div></div>

<p>When the threshold is reached, JSCause will stop writing to the log file, and compress it.  Then, it will create a new log file, and use it to continue logging.</p>

<p>For example, let’s say that the current log file is <code class="highlighter-rouge">jsc_2020-02-08_09-00-00.log</code>, indicating that it was created on Feb 8, 2020 at 9am.  Let’s suppose that the log file has reached the size threshold at 9:14am.  JSCause will compress <code class="highlighter-rouge">jsc_2020-02-08_09-00-00.log</code> and rename it to <code class="highlighter-rouge">jsc_2020-02-08_09-00-00.log.gz</code>, and continue logging to a new file named <code class="highlighter-rouge">jsc_2020-02-08_09-00-00--1.log</code>.  Notice the <code class="highlighter-rouge">--1</code> suffix.  If new files are needed, the suffix value will increment as well (<code class="highlighter-rouge">--2</code>, <code class="highlighter-rouge">--3</code>, etc.), until the time changes (in our example, to 10am).  As you can see, the time in the log files refers to the current hour.  Minutes and seconds are ignored.</p>

<p>You can read more information about how JSCause handles log files and thresholds in the <a href="#log-file-compression">Log file compression</a> section.</p>

<p><strong><em>perSite</em></strong></p>

<p>This section pertains to site logging.  “<em>perSite</em>” logging captures events related to the website only (for instance, whenever it is accessed, if the site threw an error, or if the user application logs to the console.)  This is different from “<em>general</em>”, which only logs events related to JSCause as an application (for instance, whether it started successfully, what ports are listening, if all the sites and up and running, etc.)</p>

<p>Administrators can indicate whether individual sites can have their own logging configuration or not (e.g., they can disable logging to terminal for all sites, but leave the decision of logging to file to each individual site.)</p>

<p>A “<em>perSite</em>” entry can contain the following attributes:</p>

<p><strong>- fileOutput</strong></p>

<p>This attribute indicates whether the site’s log data should be written to the file system.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"fileOutput": "enabled"
</code></pre></div></div>

<p>There are three valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Create log files and write to them.  You must provide a valid <code class="highlighter-rouge">directoryName</code> entry in the site’s <code class="highlighter-rouge">site.json</code> configuration file.  <a href="#sitejson-configuring-your-websites-details">Read more in the site.json section</a>.</li>
  <li><code class="highlighter-rouge">disabled</code>:  No creating log files or writing to them.  In this case, <code class="highlighter-rouge">directoryName</code> can be optional.</li>
  <li><code class="highlighter-rouge">perSite</code>:  Leave it to the sites’ <code class="highlighter-rouge">site.json</code> configuration.</li>
</ul>

<p><strong>- consoleOutput</strong></p>

<p>This attribute indicates whether the site’s log data should be printed to the terminal.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"consoleOutput": "enabled"
</code></pre></div></div>

<p>There are three valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Print to the terminal.</li>
  <li><code class="highlighter-rouge">disabled</code>:  No printing to the terminal whatsoever.</li>
  <li><code class="highlighter-rouge">perSite</code>:  Leave it to the sites’ <code class="highlighter-rouge">site.json</code> configuration.</li>
</ul>

<h3 id="requesttimeoutsecs">requestTimeoutSecs:</h3>

<p>This attribute sets the time in seconds JSCause will wait for a request to be handled.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"requestTimeoutSecs": 60
</code></pre></div></div>

<p>The timing starts when the request is created due to a web client contacting JSCause.  It includes the time it takes for the client to finish sending the request (including POST bodies and file uploads), and the time it takes for the website (read, JSCP files) to process the request and send a response.  It also includes the time JSCause takes giving the response for the operating system (OS) to send back to the web client.</p>

<p>So, when JSCause gives the whole response for the operating system to handle, <code class="highlighter-rouge">requestTimeoutSecs</code> stops applying.  This means that the response could take longer than the time specified in <code class="highlighter-rouge">requestTimeoutSecs</code>, simply because it’s not longer under JSCause’s control, but the operating system’s.</p>

<p>If the request exceeds the time specified by <code class="highlighter-rouge">requestTimeoutSecs</code>, JSCause will respond with an HTTP 408 (request timeout) error.</p>

<p>If <code class="highlighter-rouge">requestTimeoutSecs</code> is 0, no timeout is set and, therefore, the request can take as long as it needs.</p>

<p>Here is an example configuration:</p>

<h2 id="example-jscauseconf-configuration">Example jscause.conf configuration</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "sites": [
    {
      "name": "My Site",
      "port": 3000,
      "rootDirectoryName": "mysite",
      "enableHTTPS": false // If true, provide cert information in site.json
    }
  ],
  "logging": {
    "general": {
      "directoryName": "./logs",
      "fileOutput": "enabled",
      "consoleOutput": "enabled"
    },
    "perSite": {
      "fileOutput": "per site",
      "consoleOutput": "per site"
    }
  },
  "requestTimeoutSecs": 60
}
</code></pre></div></div>

<h2 id="sitejson-configuring-your-websites-details">site.json: Configuring your website’s details</h2>

<p>Once JSCause completes initialization via the <code class="highlighter-rouge">jscause.conf</code> file, it will proceed to read the configuration of the website (or websites, if there is more than one.)  JSCause knows how to find this configuration thanks to the <code class="highlighter-rouge">rootDirectoryName</code> attribute declared for each website in <code class="highlighter-rouge">jscause.conf</code>.  <code class="highlighter-rouge">rootDirectoryName</code> indicates where JSCause can find a subdirectory with all the website information.  Such subdirectory will be inside the <code class="highlighter-rouge">sites</code> directory found in the same directory <code class="highlighter-rouge">jscause.js</code>, the main JSCause application, is in.  Once in it, it will then proceed to look for a <code class="highlighter-rouge">configuration</code> subdirectory, then look inside it for a <code class="highlighter-rouge">site.json</code> file.</p>

<p>So, in the example in the previous section, the website has a <code class="highlighter-rouge">rootDirectoryName</code> of “mysite”.  Therefore, JSCause will look for, and read the <code class="highlighter-rouge">sites/mysite/configuration/site.json</code> file.</p>

<p>Just like with <code class="highlighter-rouge">jscause.conf</code>, <code class="highlighter-rouge">site.json</code> is a <em>sort of</em> JSON object (it accepts comments that start with <code class="highlighter-rouge">//</code>.)</p>

<p>The options, in the form of attributes, are case insensitive (i.e. <code class="highlighter-rouge">hostName</code> can be written as <code class="highlighter-rouge">hostname</code>, <code class="highlighter-rouge">Hostname</code>, <code class="highlighter-rouge">HOSTNAME</code>, etc.)  They are listed below:</p>

<p><strong><em>hostName:</em></strong></p>

<p>This is the site’s host name.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"hostName": "example.com"
</code></pre></div></div>

<p>The host name must coincide with the web client’s request host name for JSCause to serve the contents from this site.  So, if <code class="highlighter-rouge">hostName</code> is <code class="highlighter-rouge">jscausesite1</code> but the client requests content from <code class="highlighter-rouge">othersite1</code>, even if it’s the same IP address, JSCause will not respond.</p>

<p>More than one site can share the same host name, as long as they use different ports.</p>

<p><strong><em>canUpload:</em></strong></p>

<p>This attribute determines whether a site can accept POST requests or file uploads, or not.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"canUpload": true
</code></pre></div></div>

<p>The valid values are <code class="highlighter-rouge">true</code> and <code class="highlighter-rouge">false</code>.</p>

<p>If <code class="highlighter-rouge">true</code>, POST requests and uploads are accepted.  If <code class="highlighter-rouge">false</code>, the server will attempt to respond with an HTTP 403 (forbidden) error.  At the same time as the response attempt, it will certainly and immediately close the connection.</p>

<p><strong><em>maxPayloadSizeBytes:</em></strong></p>

<p>This attribute determines the size in bytes of the upload payload in a POST request or file upload.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"maxPayloadSizeBytes": 1024
</code></pre></div></div>

<p>If a payload size exceeds the amount specified in <code class="highlighter-rouge">maxPayloadSizeBytes</code>, JSCause will attempt to respond with an HTTP 413 (payload too large) error.  At the same time as the response attempt, it will certainly and immediately close the connection.  If this is not desired, it is advised that an upper limit is set and handled within the application.  Also, the application could warn the visitor beforehand.</p>

<p>If <code class="highlighter-rouge">maxPayloadSizeBytes</code> is 0, then JSCause assumes no payload size limit (use this with caution.)  If it’s less than 0, JSCause will treat is as if <code class="highlighter-rouge">canUpload</code> is <code class="highlighter-rouge">false</code>.</p>

<p><strong><em>jscpExtensionRequired:</em></strong></p>

<p>This attribute determines whether a query string, or route, must include <code class="highlighter-rouge">.jscp</code> to refer to a JSCP file.</p>

<p>As an example, let’s assume we have the <code class="highlighter-rouge">mysite/page_one.jscp</code> file.  If <code class="highlighter-rouge">jscpExtensionRequired</code> is set as <code class="highlighter-rouge">always</code>, then the URL referring to the index file must include <code class="highlighter-rouge">.jscp</code> in it:  <code class="highlighter-rouge">http://example.com/page_one.jscp</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"jscpExtensionRequired": "optional"
</code></pre></div></div>

<p>There are three valid values:</p>
<ul>
  <li>
    <p><code class="highlighter-rouge">never</code>:  The URL must <em>never</em> include <code class="highlighter-rouge">.jscp</code>.  So, in the example above, <code class="highlighter-rouge">http://example.com/page_one.jscp</code> will throw an HTTP 404 (not found) error.  <code class="highlighter-rouge">http://example.com/page_one</code> will work.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">always</code>:  The URL must <em>always</em> include <code class="highlighter-rouge">.jscp</code>.  In the example above, <code class="highlighter-rouge">http://example.com/page_one</code> will throw an HTTP 404 (not found) error.  <code class="highlighter-rouge">http://example.com/page_one.jscp</code> will work.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">optional</code>:  The URL may include <code class="highlighter-rouge">.jscp</code>, but it’s not required to.  In the example above, both <code class="highlighter-rouge">http://example.com/page_one</code> and <code class="highlighter-rouge">http://example.com/page_one.jscp</code> will work and refer to the same <code class="highlighter-rouge">page_one.jscp</code> file.</p>
  </li>
</ul>

<p><strong><em>httpPoweredByHeader:</em></strong></p>

<p>This attribute determines whether JSCause will include the following header entry in a response: <code class="highlighter-rouge">X-Powered-By: jscause</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"httpPoweredByHeader": "include"
</code></pre></div></div>

<p>There are two valid values:</p>
<ul>
  <li>
    <p><code class="highlighter-rouge">include</code>:  Include the <code class="highlighter-rouge">X-Powered-By</code> header entry in the response.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">excluse</code>:  Omit the <code class="highlighter-rouge">X-Powered-By</code> header entry from the response.</p>
  </li>
</ul>

<p><strong><em>httpsCertFile:</em></strong></p>

<p>This attribute indicates the name of your certificate file, which is required for HTTPS.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"httpsCertFile": "your-cert-file.pem"
</code></pre></div></div>

<p>This file must be placed inside the <code class="highlighter-rouge">configuration/certs</code> subdirectory, which is relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.  For example,  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code>, <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, and <code class="highlighter-rouge">httpsCertFile</code> is <code class="highlighter-rouge">your-cert-file.pem</code>, then the latter will be intepreted as <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite/configuration/certs/your-cert-file.pem</code>.</p>

<p>Note: The default installation of JSCause includes an example cert file called <code class="highlighter-rouge">jscause-cert.pem</code>.  Do <em>NOT</em> use this in production!  User’s browsers will emit a security warning.</p>

<p><strong><em>httpsKeyFile:</em></strong></p>

<p>This attribute indicates the name of your certificate’s private key file, which is required for HTTPS.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"httpsKeyFile": "your-key-file.pem"
</code></pre></div></div>

<p>This file must be placed inside the <code class="highlighter-rouge">configuration/certs</code> subdirectory, which is relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.  For example,  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code>, <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, and <code class="highlighter-rouge">httpsCertFile</code> is <code class="highlighter-rouge">your-key-file.pem</code>, then the latter will be intepreted as <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite/configuration/certs/your-key-file.pem</code>.</p>

<p>Note: The default installation of JSCause includes an example key file called <code class="highlighter-rouge">jscause-key.pem</code>.  Do <em>NOT</em> use this in production!  User’s browsers will emit a security warning.</p>

<p><strong><em>tempWorkDirectory:</em></strong></p>

<p>This attribute indicates the location of a temporary directory JSCause can use for internal operation purposes (e.g. file uploads.)  Avoid reading or manipulating this directory directly in your application.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"tempWorkDirectory": "./workbench"
</code></pre></div></div>

<p>Make sure that this directory is writeable by JSCause.</p>

<p>The path MUST be relative (e.g. <code class="highlighter-rouge">./workbench</code>).  It will be relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.</p>

<p>For example:  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code>, <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, and <code class="highlighter-rouge">tempWorkDirectory</code> is <code class="highlighter-rouge">./workbench</code>, then the latter will be located at <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite/workbench</code>.</p>

<p><code class="highlighter-rouge">rootDirectoryName</code> must be valid if <code class="highlighter-rouge">canUpload</code> is <code class="highlighter-rouge">true</code>.</p>

<p><strong><em>mimeTypes:</em></strong></p>

<p>This attribute sets a list of MIME types JSCause can associate to certain file/resource extensions.  For example, the <code class="highlighter-rouge">.html</code> file extension is associated with the <code class="highlighter-rouge">text/html</code> MIME type, then JSCause reports this to the requesting client (browser or otherwise) when responding to a request.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"mimeTypes": {
  "include": {
    // Mime types to accept.
  },
  "exclude": {
    // Mime types to exclude or reject.
  }
}
</code></pre></div></div>

<p><strong>- include</strong></p>

<p>This is an object with file extensions as keys, and MIME types as values.  When a client requests a resource with a file extension, JSCause will include in the response the type of file indicated in this list.  For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "include": {
    "png": "image/png",
    "some_other_type": "some_other_value"
  }
</code></pre></div></div>

<p>In the example above, when the client requests a PNG resource, JSCause will respond indicating that the resource is of type <code class="highlighter-rouge">image/png</code>.</p>

<p>If you specify an empty string as a value, it will be assumed <code class="highlighter-rouge">application/octet-stream</code>, and a warning will be shown in the server console during startup.</p>

<p>There are a few MIME types that JSCause will handle automatically, so they don’t need to be added to the <code class="highlighter-rouge">"include"</code> list.  Those are:</p>

<ul>
  <li><code class="highlighter-rouge">css</code>: <code class="highlighter-rouge">text/css; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">eot</code>: <code class="highlighter-rouge">application/vnd.ms-fontobject</code></li>
  <li><code class="highlighter-rouge">gif</code>: <code class="highlighter-rouge">image/gif</code></li>
  <li><code class="highlighter-rouge">html</code>: <code class="highlighter-rouge">text/html; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">ico</code>: <code class="highlighter-rouge">image/x-icon</code></li>
  <li><code class="highlighter-rouge">jpg</code>: <code class="highlighter-rouge">image/jpg</code></li>
  <li><code class="highlighter-rouge">js</code>: <code class="highlighter-rouge">text/javascript; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">json</code>: <code class="highlighter-rouge">application/json; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">mp4</code>: <code class="highlighter-rouge">video/mp4</code></li>
  <li><code class="highlighter-rouge">otf</code>: <code class="highlighter-rouge">application/font-otf</code></li>
  <li><code class="highlighter-rouge">png</code>: <code class="highlighter-rouge">image/png</code></li>
  <li><code class="highlighter-rouge">svg</code>: <code class="highlighter-rouge">application/image/svg+xml; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">ttf</code>: <code class="highlighter-rouge">application/font-ttf</code></li>
  <li><code class="highlighter-rouge">txt</code>: <code class="highlighter-rouge">text/plain; charset=utf-8</code></li>
  <li><code class="highlighter-rouge">wav</code>: <code class="highlighter-rouge">audio/wav</code></li>
  <li><code class="highlighter-rouge">woff</code>: <code class="highlighter-rouge">application/font-woff</code></li>
</ul>

<p><strong>- exclude</strong></p>

<p>Unlike <code class="highlighter-rouge">"include"</code>, this attribute is an <em>array</em>, listing all the file extensions that JSCause must <em>not</em> send a specific MIME type for.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"exclude": {
  ["jpg", "docx", "etc"]
}
</code></pre></div></div>

<p>An <code class="highlighter-rouge">application/octet-stream</code> will be sent instead, which may prompt a web browser to download the resource instead of attempting to display it (this, of course, will depend on the browser.)</p>

<p>If the same mime type is added to both <code class="highlighter-rouge">"include"</code> and <code class="highlighter-rouge">"exclude"</code> lists, the lattermost list will prevail (i.e. if <code class="highlighter-rouge">"exclude"</code> is defined after <code class="highlighter-rouge">"include"</code>, then the MIME type will be excluded.)</p>

<p>If a MIME type is defined more than once in the <code class="highlighter-rouge">"include"</code> list, JSCause makes no guarantees as to which value is ultimately used.</p>

<p><strong><em>logging:</em></strong></p>

<p>Just like in <a href="#logging"><code class="highlighter-rouge">site.conf</code></a>, this is a list of attributes to indicate what aspects of the website JSCause will log, and how:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"logging": {
  // Attributes pertaining website logging.
}
</code></pre></div></div>

<p><strong>- fileOutput</strong></p>

<p>This attribute indicates whether the log data should be written to the file system.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"fileOutput": "enabled"
</code></pre></div></div>

<p>There are two valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Create log files and write to them.  You must provide a valid <code class="highlighter-rouge">directoryName</code> entry (read below.)</li>
  <li><code class="highlighter-rouge">disabled</code>:  No creating log files or writing to them.  In this case, <code class="highlighter-rouge">directoryName</code> can be optional.</li>
</ul>

<p><strong>- directoryName</strong></p>

<p>This is the path of the directory to be used to store JSCause’s website log data.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"directoryName": "./localLogs"
</code></pre></div></div>

<p>The path can be absolute (e.g. <code class="highlighter-rouge">/home/user_name/server_data/mysite/localLogs</code>) or relative (e.g. <code class="highlighter-rouge">./localLogs</code>).  If relative, it will be relative to the website directory.</p>

<p>If you specify a <code class="highlighter-rouge">directoryName</code>, then it <em>must</em> exist regardless of whether <code class="highlighter-rouge">fileOutput</code> is true or false.  However, and unlike its counterpart in <code class="highlighter-rouge">jscause.conf</code>, if <code class="highlighter-rouge">fileOutput</code> is false, <code class="highlighter-rouge">directoryName</code> is optional (and therefore, it can be omitted.)</p>

<p><strong>- consoleOutput</strong></p>

<p>This attribute indicates whether the log data should be printed to the terminal.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"consoleOutput": "enabled"
</code></pre></div></div>

<p>There are two valid values:</p>
<ul>
  <li><code class="highlighter-rouge">enabled</code>:  Print to the terminal.</li>
  <li><code class="highlighter-rouge">disabled</code>:  No printing to the terminal whatsoever.</li>
</ul>

<p>To learn more about what type of data JSCause logs for websites, please check out the <a href="#logging">logging section</a>.</p>

<h2 id="example-sitejson-configuration">Example site.json configuration</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "hostName": "example.com",
  "canUpload": true,
  "maxPayloadSizeBytes": 0,
  "jscpExtensionRequired": "optional",
  "httpPoweredByHeader": "include",
  "httpsCertFile": "jscause-cert.pem", // Use your own cert file.
  "httpsKeyFile": "jscause-key.pem", // Use your own key file.
  "tempWorkDirectory": "./workbench",
  "mimeTypes": {
    "include": {
        "abw": "application/x-abiword",
        "mid": "audio/midi"
    },
    "exclude": [
        "odp",
        "zip"
    ]
  },
  "logging": {
    "directoryName": "./localLogs",
    "consoleOutput": "enabled",
    "fileOutput": "enabled"
  }
}
</code></pre></div></div>

<h2 id="starting-up-jscause">Starting up JSCause</h2>

<p>Once you have configured JSCause and your website, you can run it by changing to the JSCause directoru and issuing the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node jscause
</code></pre></div></div>

<p>JSCause will print out the following (may differ depending on your configuration):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*** JSCause Server version [VERSION NUMBER HERE]
INFO: Reading configuration for site 'My Site' from 'sites/mysite'
INFO: Site 'My Site' at https://example.com:80/ assigned to server 0
INFO: ************ All sites' configuration read at this point ********************
INFO: The following sites were set up successfully:
INFO: 'My Site'
INFO: Will start listening.
INFO: Server 0 listening on port 80
</code></pre></div></div>

<p>If the last line is about a server listening on a port, then everything was configured correctly.  Having said that, do check for warning messages (for example: <code class="highlighter-rouge">WARNING: Site configuration: Site 'My Site' has file logging enabled while the server has per-site file logging disabled.</code>)</p>

<p>If you get a warning or an error, refer to the <a href="#faq-and-troubleshooting-jscause">troubleshooting section</a> to find out how to address it.</p>

<h2 id="stopping-jscause">Stopping JSCause</h2>

<p>You can stop JSCause simply by issuing Ctrl+C in the terminal:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>^C
Received interrupt signal.  Cleaning up before exiting...
Terminated.
</code></pre></div></div>

<p>Or you can send the SIGTERM signal to the JSCause process via the <code class="highlighter-rouge">kill</code> command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ killall node jscause
Received interrupt signal.  Cleaning up before exiting...
Terminated.

[1]+  Done                    node jscause
</code></pre></div></div>

<h2 id="the-website-directory-all-your-websites-content">The website/ directory: All your website’s content</h2>

<p>JSCause will serve everything you place inside the <code class="highlighter-rouge">website</code> directory to the public.  The directory tree of this directory will map the routing tree of your website.</p>

<p>For example, let’s assume that you have a website configured for <code class="highlighter-rouge">https://www.example.com</code>.</p>

<p>If you have the following three files inside <code class="highlighter-rouge">website</code>:</p>

<ul>
  <li><code class="highlighter-rouge">website/index.html</code></li>
  <li><code class="highlighter-rouge">website/scripts/app.js</code></li>
  <li><code class="highlighter-rouge">website/css/styles.css</code></li>
</ul>

<p>Then JSCause will deliver their content when a web client (like a web browser) hits these corresponding urls:</p>

<ul>
  <li><code class="highlighter-rouge">https://www.example.com/index.html</code></li>
  <li><code class="highlighter-rouge">https://www.example.com/scripts/app.js</code></li>
  <li><code class="highlighter-rouge">https://www.example.com/css/styles.css</code></li>
</ul>

<h3 id="jscp-files">JSCP files</h3>

<p>JSCP files end in <code class="highlighter-rouge">.jscp</code>, and are considered executable.  Therefore, they are <em>run</em> instead of having their content delivered.</p>

<p>For example, if you have an <code class="highlighter-rouge">index.jscp</code> file with the following content:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.print('Hello, number ' + (2 + 2).toString());
</code></pre></div></div>

<p>Then visiting <code class="highlighter-rouge">https://www.example.com/index.jscp</code> in a web browser will display:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello, number 4
</code></pre></div></div>

<p>JSCause will only run JSCP files only if they are located in a site’s <code class="highlighter-rouge">website</code> directory.  If you need to run files outside of <code class="highlighter-rouge">website</code>, <a href="#site-contents-files-and-directories">use symlinks</a> (use this feature with caution.)</p>

<p><strong>Important</strong>: JSCP file names are case-sensitive (if the file system allows it.)  A file will be considered JSCP only if its extension is lower case (that is, <code class="highlighter-rouge">.jscp</code> is valid, but <code class="highlighter-rouge">.JSCP</code> is not.)</p>

<h3 id="jscm-files">JSCM files</h3>

<p>Files ending in <code class="highlighter-rouge">.jscm</code> are considered executable modules, which can be called by <code class="highlighter-rouge">.jscp</code> files.</p>

<p>JSCM files will never be served directly.  JSCause will issue an HTTP 404 error if it receives a direct request for one.</p>

<p><code class="highlighter-rouge">https://www.example.com/module.jscp --&gt; 404 error</code></p>

<p>JSCause will only run JSCM files only if they are located in a site’s <code class="highlighter-rouge">website</code> directory.  If you need to run files outside of <code class="highlighter-rouge">website</code>, <a href="#site-contents-files-and-directories">use symlinks</a> (use this feature with caution.)</p>

<p><strong>Important</strong>: Just like JSCP file names, JSCM file names are case-sensitive (if the file system allows it.)  A file will be considered JSCM only if its extension is lower case (that is, <code class="highlighter-rouge">.jscm</code> is valid, but <code class="highlighter-rouge">.JSCM</code> is not.)</p>

<h3 id="index-files">Index files</h3>

<p>An <code class="highlighter-rouge">index.jscp</code> file is considered an <em>index file</em>, and serve as the default when a resource/file is omitted in a url (<strong>Note</strong>: <code class="highlighter-rouge">index.html</code> will not work as an index file.  This might be allowed in a future version.)</p>

<p>For example, if your website is hosted at <code class="highlighter-rouge">https://www.example.com</code> and it has the following file:</p>

<p><code class="highlighter-rouge">website/index.jscp</code></p>

<p>Then a web browser can request said file with either <code class="highlighter-rouge">https://www.example.com/index.jscp</code> or just <code class="highlighter-rouge">https://www.example.com</code></p>

<p>Another example:</p>

<p>If the following file exists:</p>

<p><code class="highlighter-rouge">website/stories/index.jscp</code></p>

<p>Then it can be requested via <code class="highlighter-rouge">https://www.example.com/stories/index.jscp</code> or just <code class="highlighter-rouge">https://www.example.com/stories</code></p>

<h3 id="all-the-routing-rules">All the routing rules</h3>

<p>When JSCause receives a request, it applies the following rules to determine which file to serve:</p>

<ol>
  <li>
    <p>If the url is <code class="highlighter-rouge">/</code>, <code class="highlighter-rouge">/index.jscp</code> will be assumed (see #5.)</p>
  </li>
  <li>
    <p>If the url is <code class="highlighter-rouge">/name.jscp</code> (or <code class="highlighter-rouge">/directory/name.jscp</code>), JSCause will check for the file.  If it exists, and <em><code class="highlighter-rouge">jscpExtensionRequired</code></em> is either <code class="highlighter-rouge">optional</code> or <code class="highlighter-rouge">always</code>, it will run it (see #5.)  If it doesn’t, or if the url ends in <code class="highlighter-rouge">/</code> (e.g. <code class="highlighter-rouge">/directory/name/</code> or, if <em><code class="highlighter-rouge">jscpExtensionRequired</code></em> is either <code class="highlighter-rouge">optional</code> or <code class="highlighter-rouge">always</code>, <code class="highlighter-rouge">/directory/name.jscp/</code>), it will assume it’s a directory (see #4.)</p>
  </li>
  <li>
    <p>If the url is <code class="highlighter-rouge">/name</code> (or <code class="highlighter-rouge">/directory/name</code>), and if <em><code class="highlighter-rouge">jscpExtensionRequired</code></em> is either <code class="highlighter-rouge">never</code> or <code class="highlighter-rouge">optional</code>, JSCause will check for the file <code class="highlighter-rouge">/name.jscp</code> (or <code class="highlighter-rouge">/directory/name.jscp</code>.)  If it exists, it will run it (see #5.)  If the file name does not exist, or if the url ends in <code class="highlighter-rouge">/</code>, it will assume it’s a directory (see #4.)</p>
  </li>
  <li>
    <p>If the url refers to a directory (e.g. <code class="highlighter-rouge">/name</code> or <code class="highlighter-rouge">/name/</code>), check for <code class="highlighter-rouge">/name/index.jscp</code>.  This check happens regardless of the value of <em><code class="highlighter-rouge">jscpExtensionRequired</code></em>.</p>
  </li>
  <li>
    <p>If the extension is <code class="highlighter-rouge">.jscp</code> (e.g. <code class="highlighter-rouge">/name.jscp</code> or <code class="highlighter-rouge">/directory/name.jscp</code>), and again, if <em><code class="highlighter-rouge">jscpExtensionRequired</code></em> is either <code class="highlighter-rouge">optional</code> or <code class="highlighter-rouge">always</code> (unless we’re coming from #3, in which case <code class="highlighter-rouge">never</code> is overriden), then JSCause will run the contents and serve its output.</p>
  </li>
  <li>
    <p>If the url is <code class="highlighter-rouge">/name.extension</code>, with the extension being neither <code class="highlighter-rouge">.jscp</code> nor <code class="highlighter-rouge">.jscm</code> (or not present), JSCause will check for the file.  If it exists, JSCause will serve the contents of it (i.e., it is assumed a static resource.)</p>
  </li>
  <li>
    <p>If the extension is <code class="highlighter-rouge">.jscm</code>, serve an HTTP 404 error.</p>
  </li>
  <li>
    <p>If none of the above applies, serve an HTTP 404 error.</p>
  </li>
</ol>

<h2 id="the-runtime-framework">The runtime framework</h2>

<p>When a web client requests a JSCP file (a file ending in <code class="highlighter-rouge">.jscp</code>), JSCause will execute it, then sends the result of the execution as a response.</p>

<p>JSCP files combine HTML and Javascript.  Let’s go through three different scenarios.</p>

<h3 id="jscp-with-javascript-only">JSCP with Javascript only</h3>

<p>A JSCP file can contain just Javascript code.  To send a response back to the web client, use the command <code class="highlighter-rouge">rt.print</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// This is a valid JSCP program
rt.print('Hello, Javascript');
</code></pre></div></div>

<p>When a browser access this file (e.g. <code class="highlighter-rouge">index.jscp</code>), it will display <code class="highlighter-rouge">Hello, Javacript</code> back to the user.</p>

<h3 id="jscp-with-html-only">JSCP with HTML only</h3>

<p>To let JSCP know that the whole file is HTML, start it with <code class="highlighter-rouge"><span class="nt">&lt;html</span> <span class="nt">/&gt;</span></code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;&lt;title&gt;</span>Sample HTML document<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;&lt;h1&gt;</span>Hello, HTML<span class="nt">&lt;/h1&gt;&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>When a browser access this file (e.g. <code class="highlighter-rouge">index.jscp</code>), it will display <code class="highlighter-rouge">Hello, HTML</code> back to the user.</p>

<p>Note: You can replace <code class="highlighter-rouge"><span class="nt">&lt;html</span> <span class="nt">/&gt;</span></code> with <code class="highlighter-rouge">&lt;js/js&gt;</code> and achieve the same thing above.</p>

<h3 id="jscp-with-both-html-and-javascript">JSCP with both HTML and Javascript</h3>

<p>Enclose your Javascript code within <code class="highlighter-rouge">&lt;js&gt;</code> tags (<code class="highlighter-rouge">&lt;js</code> and <code class="highlighter-rouge">/js&gt;</code>).  Anything outside of the tags will be considered HTML.</p>

<p>Here’s an example - The value of PI:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;&lt;title&gt;</span>Sample HTML document<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Hello, PI<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;p&gt;</span>PI is: <span class="nt">&lt;js</span> <span class="na">rt</span><span class="err">.</span><span class="na">print</span><span class="err">(</span><span class="na">Math</span><span class="err">.</span><span class="na">PI</span><span class="err">);</span> <span class="err">/</span><span class="na">js</span><span class="nt">&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>Notice that there is no need to include <code class="highlighter-rouge"><span class="nt">&lt;html</span> <span class="nt">/&gt;</span></code> at the top of a file if it contains executable Javascript code.</p>

<p>Another example - Children 3 years and under enter the theater for free:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;js const randomAge = Math.floor(Math.random() * 120); /js&gt;
&lt;p&gt;John's age is: &lt;js rt.print(randomAge); /js&gt;&lt;/p&gt;
&lt;js if (randomAge &lt;= 3) { /js&gt;
  &lt;p&gt;John can enter the theater for free.&lt;/p&gt;
&lt;js } else { /js&gt;
  &lt;p&gt;John will need a ticket in order to enter the theater.&lt;/p&gt;
&lt;js } /js&gt;
</code></pre></div></div>

<p>Alternatively:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;js
  const randomAge = Math.floor(Math.random() * 120);
  const message = (randomAge &lt;= 3) ?
    'John can enter the theater for free.' :
    'John will need a ticket in order to enter the theater.';
/js&gt;
&lt;p&gt;John's age is: &lt;js rt.print(randomAge); /js&gt;&lt;/p&gt;
&lt;p&gt;&lt;js rt.print(message); /js&gt;&lt;/p&gt;
</code></pre></div></div>

<h3 id="the-rt-runtime-object">The rt runtime object</h3>

<p><code class="highlighter-rouge">rt</code> stands for “runtime,” and it’s the object that contains a library of convenient methods and variables to make things easier for you, the developer.</p>

<p><code class="highlighter-rouge">rt</code> exists in every JSCP file.  To use it in JSCM modules, the calling JSCP file will need to pass it <code class="highlighter-rouge">rt</code> as a parameter - see the previous section, <a href="#rt-in-modules">rt in modules</a>.</p>

<p>A complete reference <a href="#the-rt-runtime-object-reference">can be found here</a>.</p>

<h3 id="jscause-modules-jscm-files">JSCause modules: JSCM files</h3>

<p>JSCM files have the <code class="highlighter-rouge">.jscm</code> extension.  They are essentially regular Javascript modules.  You can import them in your program with the <code class="highlighter-rouge">rt.module()</code> instruction:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const myModule = rt.module('myModule');
</code></pre></div></div>

<p>Example:</p>

<p>Let’s create a <code class="highlighter-rouge">sum.jscm</code> module file with the following contents:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module.exports = {
  addTwo(a, b)
  {
    return a + b;
  },
  numberFive: 5
};
</code></pre></div></div>

<p>And an <code class="highlighter-rouge">index.jscp</code> file with the following contents:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const sumModule = rt.module('sum');

rt.print(sumModule.addTwo(1, 2));
rt.print(' and ');
rt.print(sumModule.numberFive);
</code></pre></div></div>

<p>When we hit <code class="highlighter-rouge">/index.jscp</code> in the browser, the following will be displayed in the browser window:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 and 5
</code></pre></div></div>

<h3 id="rt-in-modules">rt in modules</h3>

<p>You may notice that <code class="highlighter-rouge">rt</code> is not available in modules, at least, not directly.  So, instructions such as <code class="highlighter-rouge">rt.print</code> are not available.</p>

<p>Consider this module:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module.exports = {
  twoSum(a, b)
  {
    rt.print(a,b);
  }
};
</code></pre></div></div>

<p>If we import it in our code as <code class="highlighter-rouge">printSum</code>, and attempt to use <code class="highlighter-rouge">twoSum()</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  const printSum = rt.module('printSum');
  printSum.twoSum(1, 2);
</code></pre></div></div>

<p>JSCause will report an HTTP error 500 back to the browser, and print something similar to the following to the console:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Site: My Site: Runtime error on file /index.jscp: rt is not defined at line 1
ReferenceError: rt is not defined
    at Object.addTwo (/jscause_path/sites/mysite/website/sum.jscm:5:7)
    at ... [etc]
Fri, 17 Jan 2020 05:05:26 GMT - example.com - GET: / - 500
</code></pre></div></div>

<p>To overcome that, we can pass the <code class="highlighter-rouge">rt</code> object to the module as a function parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module.exports = function(rt)
{
  return {
    twoSum(a, b) {
      rt.print(a,b);
    }
  };
};
</code></pre></div></div>

<p>Then we modify our main code:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  const printSum = rt.module('printSum')(rt);
  printSum.twoSum(1, 2);
</code></pre></div></div>

<p>We’ll no longer get an HTTP error 500, and the browser will display <code class="highlighter-rouge">3</code>.</p>

<h2 id="redirection">Redirection:</h2>

<p>To redirect to a different URL, use <a href="#rtredirectto"><code class="highlighter-rouge">rt.redirectTo()</code></a>.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.redirectTo('https://www.example.com', 5); // Redirect after five seconds.
</code></pre></div></div>

<p>The redirection will happen right after JSCause executes all the code in the current JSCP file. That’s when the content is delivered to the web browser, including the redirection instruction.</p>

<p>If, later in your code, it is determined that you no longer need to redirect, you can use <a href="#rtresetredirectto"><code class="highlighter-rouge">rt.resetRedirectTo()</code></a>.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.redirectTo('https://www.example.com');

const coinFlipIsTails = (Math.random() &gt;= 0.5);
if (coinFlipIsTails) {
  rt.resetRedirectTo();
}
</code></pre></div></div>

<h2 id="callbacks">Callbacks</h2>

<p>If your code invokes callbacks, chances are they won’t be run in time before JSCause delivers the response to the web client.</p>

<p>Take this example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function andThree() {
  rt.print('And three!');
}

rt.print('One! ');
setTimeout(andThree, 10);
rt.print('Two! ');
</code></pre></div></div>

<p>When making this request, the browser will display the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>One! Two!
</code></pre></div></div>

<p>We were expecting to see “One! Two! And three!”.  The <code class="highlighter-rouge">andThree()</code> callback _ did run_, but too late - JSCause had already sent the response to the browser.</p>

<p>We must signal JSCause that it must wait for the callback to complete.  We do that by enclosing it with <a href="#rtwaitfor"><code class="highlighter-rouge">rt.waitFor()</code></a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function andThree() {
  rt.print('And three!');
}

rt.print('One! ');
setTimeout(rt.waitFor(andThree), 10);
rt.print('Two! ');
</code></pre></div></div>

<p>When making this request, the browser will correctly display the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>One! Two! And three!
</code></pre></div></div>

<p>Notice that <code class="highlighter-rouge">rt</code> methods, such as <code class="highlighter-rouge">rtOnSuccess()</code>, do <em>not</em> require their callbacks to be enclosed with <code class="highlighter-rouge">rt.waitFor()</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function reportSuccess() {
  rt.print('File read successfully!');
}
rt.readFile('my_source.txt', 'utf-8')
  .rtOnSuccess(reportSuccess); // This is correct.  No need for rt.waitFor() here.
</code></pre></div></div>

<p>You can read more about this behavior in the next section about <a href="#rt-promises">RT Promises</a>.</p>

<h2 id="rt-promises">RT Promises:</h2>

<p>RT Promises refers to the mechanism some <code class="highlighter-rouge">rt</code> methods use to deal with the asynchronous nature of their operations.  They seek to emulate Javascript’s Promises.  One important difference is that RT Promises will always involve two methods, <code class="highlighter-rouge">rtOnSuccess()</code> and <code class="highlighter-rouge">rtOnError()</code>.</p>

<p>Here’s an example.  First, let’s use regular Javascript promises.  Let’s assume that <code class="highlighter-rouge">promisedReadFile()</code> reads a file and returns a Promise object.  In that case, we can write the following code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>promisedReadFile('some_file.txt')
  .then((response) =&gt; {
    console.log('File reading succeeded:');
    console.log(response);
  })
  .catch((err) =&gt; {
    console.log('File reading failed:');
    console.log(err);
  });
</code></pre></div></div>

<p>The JSCause way to do the above would be:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.readFile('some_file.txt')
  .rtOnSuccess((response) =&gt; {
    console.log('File reading succeeded:');
    console.log(response);
  })
  .rtOnError((err) =&gt; {
    console.log('File reading failed:');
    console.log(err);
  });
</code></pre></div></div>

<p>As mentioned, RT Promises, instead of expecting a <code class="highlighter-rouge">then()/catch()</code> chains, they expect <code class="highlighter-rouge">rtOnSuccess()/rtOnError()</code> chains.  Apart from the name, the major distinction is that the callbacks are guaranteed to complete before JSCause sends a response to the web client.  That is, operations involving RT Promises do not need callbacks to be enclosed with <code class="highlighter-rouge">rt.waitFor()</code> - see the previous section about <a href="#callbacks">Callbacks</a>.</p>

<p>Here is a list of JSCause methods that use RT Promises:</p>

<ul>
  <li><a href="#rtcopyfile">rt.copyFile()</a></li>
  <li><a href="#rtdeletefile">rt.deleteFile()</a></li>
  <li><a href="#rtfileexists">rt.fileExists()</a></li>
  <li><a href="#rtmovefile">rt.moveFile()</a></li>
  <li><a href="#rtreadfile">rt.readFile()</a></li>
</ul>

<p>In summary:</p>

<p>Chain any of the above calls with <code class="highlighter-rouge">.rtOnSuccess(callback)</code> to examine the result (or response).  <code class="highlighter-rouge">callback</code> has a parameter (<code class="highlighter-rouge">response</code>) with the result of the operation.</p>

<p>Chain it with <code class="highlighter-rouge">.rtOnError(callback)</code> to handle any errors in the operation.  <code class="highlighter-rouge">callback</code> has a parameter (<code class="highlighter-rouge">err</code>) with the error in question.</p>

<p>Notes:</p>

<p>These types of operations can be nested.  For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.copyFile('my_file.txt', 'my_copied_file.txt')
  .rtOnSuccess(() =&gt; {
    console.log('File copying succeeded.  Let\'s read the copy.');
    rt.readFile('my_copied_file.txt')
      .rtOnSuccess((contents) =&gt; {
        console.log('File reading succeeded!');
        console.log(contents);
      })
      .rtOnError(() =&gt; {
        console.log('File reading failed.');
      });
  })
  .rtOnError((err) =&gt; {
    console.log('File copying failed:');
    console.log(err);
  });
</code></pre></div></div>

<p>Both <code class="highlighter-rouge">rtOnSuccess()</code> and <code class="highlighter-rouge">rtOnError()</code> can be omitted.  But if any error occurs, the server will throw a runtime error:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  rt.copyFile('my_file.txt', 'my_copied_file.txt');
  // The above operation is fine.
  // However, if an error occurs, the web client will inform of
  // an HTTP 500 (internal server error) error.
</code></pre></div></div>

<p>Both <code class="highlighter-rouge">rtOnSuccess()</code> and <code class="highlighter-rouge">rtOnError()</code> can omit their parameter, that is, their callback.  Although allowed, this is not advisable from an application development standpoint.  For example, you may want to handle any potential errors.</p>

<h2 id="logging-features">Logging features</h2>

<p>When JSCause is running, it can log the activity related to requests, application messages and errors to the terminal and/or to files for archiving, later review or analysis.</p>

<p>Notice:  Any console output from the actual user application (e.g. <code class="highlighter-rouge">console.log()</code> from <code class="highlighter-rouge">index.jscp</code>) will never be captured in the log files, and will always be printed in the terminal.</p>

<p>JSCause can log activity in a global way, or per site.</p>

<p>The <a href="#logging">configuration of global logging</a> resides in the <code class="highlighter-rouge">jscause.conf</code> file.</p>

<p>When JSCause receives a request, it will generate a log entry indicating the time of the request, the type (e.g. GET or POST), the path requested, and the type of HTTP response generated and to be sent when the request completes (e.g. 200 OK, 404, etc.)</p>

<p>Here is a sample:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sun, 23 Feb 2020 00:21:17 GMT - example.com - GET: /some_folder - 200
</code></pre></div></div>

<p>Depending on the configuration, said entry will be added to a file store in the directory specified by <code class="highlighter-rouge">directoryName</code> in the <code class="highlighter-rouge">jscause.conf</code> file, and only if <code class="highlighter-rouge">fileOutput</code> is set to <code class="highlighter-rouge">enabled</code>.  Read more about the characteristics of this file in the following section about <a href="#log-file-compression">file compression</a>.</p>

<p>If <code class="highlighter-rouge">consoleOutput</code> is also <code class="highlighter-rouge">enabled</code>, the entry will be printed to the terminal window JSCause is running in.</p>

<p>When configuring logging, you must specify what operations occur globally, and what operations occur per site.</p>

<p>Operations occurring globally are configured inside the <code class="highlighter-rouge">logging</code> / <code class="highlighter-rouge">general</code> section of the <code class="highlighter-rouge">jscause.conf</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"logging": {
  "general": {
    // Attributes pertaining application-wide logging.
  }
}
</code></pre></div></div>

<p>Here you can specify <code class="highlighter-rouge">consoleOutput</code> to <code class="highlighter-rouge">enabled</code> if you want the logging to appear in the terminal, or <code class="highlighter-rouge">disabled</code> if not.  <code class="highlighter-rouge">fileOutput</code> is the same as <code class="highlighter-rouge">consoleOutput</code>, but with all the logging being saved to a directory specified by <code class="highlighter-rouge">directoryName</code>.  Here’s an example configuration:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "general": {
      "directoryName": "./logs",
      "fileOutput": "enabled",
      "consoleOutput": "enabled"
    }
  }
</code></pre></div></div>

<h3 id="types-of-data-logged">Types of data logged</h3>

<ul>
  <li>Whenever JSCause is started.  Example:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: Site 'My Site' at https://example.com:3000/ assigned to server 0
INFO: Server 0 listening on port 3000
</code></pre></div></div>

<ul>
  <li>Client requests will be logged, as well as their HTTP response status.  Example:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sun, 23 Feb 2020 00:21:17 GMT - example.com - GET: /some_folder - 200
</code></pre></div></div>

<ul>
  <li>Runtime errors.  Example:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: Site: My Site: Runtime error on file /some_file.jscp: some_invalid_funcion is not defined at line 17
ReferenceError: some_invalid_funcion is not defined
Sun, 23 Feb 2020 00:32:04 GMT - jscausesite1 - GET: /some_file.jscp - 500
</code></pre></div></div>

<h3 id="per-site-logging">Per site logging</h3>

<p>You can also dictate whether individual sites must do logging or not.  This is done under the <code class="highlighter-rouge">logging</code> / <code class="highlighter-rouge">perSite</code> section.  It’s similar to <code class="highlighter-rouge">general</code>, except that no <code class="highlighter-rouge">directoryName</code> can be defined here (this is done in each site’s individual <code class="highlighter-rouge">site.json</code> configuration file.)  Also, both <code class="highlighter-rouge">fileOutput</code> and <code class="highlighter-rouge">consoleOutput</code> allow a third option, <code class="highlighter-rouge">per site</code>, to indicate that each site will determine wheteher to log or not (again, in their corresponding <code class="highlighter-rouge">site.json</code> file.)</p>

<p>Here’s a typical configuration:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "general": {
      // General options here.
    },
    "perSite": {
      "fileOutput": "enabled", // Every site must log to a file.
      "consoleOutput": "per site"
    },
  }
</code></pre></div></div>

<p>When sites are allowed to determine their own logging configuration, JSCause will examine their corresponding <code class="highlighter-rouge">site.json</code> for a <code class="highlighter-rouge">logging</code> section:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    // Site options here.
  }
</code></pre></div></div>

<p>Just like in <code class="highlighter-rouge">jscause.conf</code> file, here you can specify three values for <code class="highlighter-rouge">consoleOutput</code> (<code class="highlighter-rouge">enabled</code>, <code class="highlighter-rouge">disabled</code>), <code class="highlighter-rouge">fileOutput</code> (<code class="highlighter-rouge">enabled</code>, <code class="highlighter-rouge">disabled</code>) and <code class="highlighter-rouge">directoryName</code>.</p>

<p>Another difference is, <code class="highlighter-rouge">directoryName</code> must be relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.  For example:  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code>, <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, and <code class="highlighter-rouge">directoryName</code> is <code class="highlighter-rouge">./localLogs</code>, then the latter will be intepreted as <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite/localLogs</code>.  Here is an example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "directoryName": "./localLogs",
    "consoleOutput": "disabled",
    "fileOutput": "enabled"
  }
</code></pre></div></div>

<p>Finally, these values will only apply if they are marked as <code class="highlighter-rouge">per site</code> in the global <code class="highlighter-rouge">perSite</code> configuration.  Otherwise, they will have no effect (will be overridden.)  For example, consider the following <code class="highlighter-rouge">jscause.conf</code> example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "perSite": {
      "fileOutput": "enabled",
      "consoleOutput": "per site"
    },
  }
</code></pre></div></div>

<p>And <code class="highlighter-rouge">site.json</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "fileOutput": "disabled",
    "consoleOutput": "disabled",
    "directoryName": "./localLogs"
  }
</code></pre></div></div>

<p>In this case, the site’s <code class="highlighter-rouge">fileOutput</code> will be <code class="highlighter-rouge">enabled</code>, and <code class="highlighter-rouge">consoleOutput</code> will be <code class="highlighter-rouge">disabled</code>.</p>

<h3 id="log-file-compression">Log file compression</h3>

<p>Log files have the following file name format: <code class="highlighter-rouge">jsc_YYYY-MM-DD_HH-00-00.log</code> (YYYY represents the current year, MM the current month, DD the current day, HH the current hour in 24-hour format,)  For example, a log file with the name <code class="highlighter-rouge">jsc_2020-02-08_09-00-00.log</code> indicates that it was created on Feb 08, 2020 at 9am.</p>

<p>When the hour changes (in hour example, from 9am to 10am), JSCause creates a new file with the new hour, and continues logging in it.</p>

<p>Since minutes and seconds are ignored, then if only a few web requests per hour are made, a new log file will be created once per hour.  If no requests are made at a specific hour, then no log file will be generated for that particular hour.</p>

<p>On the other hand, high volume sites may generate a lot of logging in one hour.  If you want to keep log files from getting too large, you can instruct JSCause to divide them up.  This is helpful for administration operations such as backing up.</p>

<p>To ensure that log files don’t go past a certain size, use the <code class="highlighter-rouge">logFileSizeThreshold</code> logging configuration option in <code class="highlighter-rouge">jscause.conf</code> (this option is not allowed in <code class="highlighter-rouge">sites.json</code>.)  It receives a numeric value representing the maximum size a log file can be - in bytes.  When this size is reached, JSCause will stop using it, and will create another empty log file, and continue logging in it.</p>

<p>The new file will be appended a numeric suffix to distinguish it from the old file, if it’s generated in the same hour.  For example, if it’s 5pm, then the log file may have a name such as <code class="highlighter-rouge">jsc_2020-02-08_17-00-00.log</code> (17:00, or 5pm.)  If the file reaches its maximum size at 5:25pm, then a new log file will be created, and named <code class="highlighter-rouge">jsc_2020-02-08_17-00-00--1.log</code>.  If that one gets filled up at 5:55pm, then a new log file is created with the name <code class="highlighter-rouge">jsc_2020-02-08_17-00-00--2.log</code>.  At 6pm, a new log file is then created with the name <code class="highlighter-rouge">jsc_2020-02-08_18-00-00.log</code> (18:00, or 6pm), and the cycle resets.</p>

<p>JSCause will compress old log files in order to save space.  When they are compressed, they are renamed so they have the <code class="highlighter-rouge">.log.gz</code> extension (for example, <code class="highlighter-rouge">jsc_2020-02-08_09-00-00--3.log.gz</code>.)  They will become smaller.  However, you should regularly move these older files to a backup media (or delete them, if you consider you don’t need them anymore), so that the storage medium they are being created on will not fill up.  A file rotation feature, in which only the most recent N files are kept, will be added in a future version.</p>

<p><strong>Important notes:</strong></p>

<ul>
  <li>
    <p>If there are file reading/writing errors during logging, then no further logging operations will take place until it’s time to compress/rotate the files.  If console output is enabled, the server will emit warnings in these cases.</p>
  </li>
  <li>
    <p>Compression of log files will happen four at a time.  If more than four files need to be compressed, the remaining will be queued.</p>
  </li>
  <li>
    <p>The process of determining log compressing on a specific site will happen only when there is something to log.  For example: If there are uncompressed log files, and the site is never accessed, or nothing is logged, the files will remain uncompressed.</p>
  </li>
  <li>
    <p>If you move compressed log files to another location, and JSCause is writing to a suffixed file (e.g., <code class="highlighter-rouge">jsc_2020-02-08_22-00-00--2.log</code>), then it will reset writing to a non-suffixed file.  This will cause log entries that will appear as out of sync with the files they’re in.  And because of the file name reset, backing it up could lead to the newer file overwriting the older one.  To avoid this, your move procedure should not move any the compressed suffixed files associated with the current (non-compressed) log file.  For example, given the following list of files: <code class="highlighter-rouge">jsc_2019-12-31_23-00-00.log.gz</code>, <code class="highlighter-rouge">jsc_2020-01-01_00-00-00.log.gz</code> and <code class="highlighter-rouge">jsc_2020-01-01_00-00-00--1.log</code>, just move <code class="highlighter-rouge">jsc_2020-12-31_23-00-00.log.gz</code>.  This will be fixed in a future version.</p>
  </li>
</ul>

<h2 id="httpsssl-configuration">HTTPS/SSL configuration</h2>

<p>To enable secure HTTPS connections on your site, you must follow these steps:</p>

<p><strong>Step 1</strong>: Have your certificate files ready:</p>

<ul>
  <li>Your SSL certificate file.  For example, <code class="highlighter-rouge">my_site.crt</code>.</li>
  <li>Your certificate’s private key file.  For example, <code class="highlighter-rouge">private.key</code>.</li>
  <li>Your certificate file from a Certificate Authority, if you have one.  For example, <code class="highlighter-rouge">cert_authority.crt</code>.</li>
</ul>

<p>Notice that the extensions of the files above may differ.  <code class="highlighter-rouge">.pem</code>, <code class="highlighter-rouge">.der</code> and <code class="highlighter-rouge">.cer</code> are also typical.</p>

<p><strong>Step 2</strong>: Place your certificate files in the <code class="highlighter-rouge">configuration/certs</code> subdirectory of your site:</p>

<p>The <code class="highlighter-rouge">configuration/certs</code> subdirectory is relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.</p>

<p>For example,  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code> and <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, then your files must reside in the following paths:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/user_name/jscause/sites/mysite/configuration/certs/my_site.crt
/home/user_name/jscause/sites/mysite/configuration/certs/private.key
/home/user_name/jscause/sites/mysite/configuration/certs/cert_authority.crt
</code></pre></div></div>

<p>Note: The default installation of JSCause includes example files called <code class="highlighter-rouge">jscause-cert.pem</code> and <code class="highlighter-rouge">jscause-key.pem</code>.  Do <em>NOT</em> use this in production!  User’s browsers will emit a security warning.</p>

<p><strong>Step 3</strong>: Configure your cert files in your site’s <code class="highlighter-rouge">site.json</code> configuration file:</p>

<p>Add the <code class="highlighter-rouge">httpsCertFile</code> and <code class="highlighter-rouge">httpsKeyFile</code> entries in the configuration file (or modify them, if they already exist):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "httpsCertFile": "my_site.crt",
  "httpsKeyFile": "private.key",
</code></pre></div></div>

<p>Notice that you must only provide the file names here.  JSCause already knows it has to look for them under <code class="highlighter-rouge">configuration/certs</code>.</p>

<p><strong>Step 4</strong>: Enable HTTPS connections in <code class="highlighter-rouge">jscause.conf</code>:</p>

<p>Add the <code class="highlighter-rouge">enableHTTPS</code> to the server’s <code class="highlighter-rouge">jscause.conf</code> configuration file (or modify it), with a value of <code class="highlighter-rouge">true</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"enableHTTPS": true
</code></pre></div></div>

<p>Note: If you set <code class="highlighter-rouge">enableHTTPS</code> to <code class="highlighter-rouge">true</code>, both <code class="highlighter-rouge">httpsCertFile</code> and <code class="highlighter-rouge">httpsKeyFile</code> are required.  If you set <code class="highlighter-rouge">enableHTTPS</code> to <code class="highlighter-rouge">false</code>, then the entries can be omitted.  However, should you decide to include them, they must be valid, non-empty strings.  Otherwise, JSCause will not start.</p>

<p><strong>Step 5</strong>: If JSCause is running, restart it.</p>

<p><strong>Important notes</strong>:</p>

<ul>
  <li>
    <p>Each HTTPS site should use its own port.  JSCause will emit a warning if two HTTPS sites share the same port, or if an HTTP site shares the port with an already configured HTTPS site.</p>
  </li>
  <li>
    <p>For security purposes, an HTTPS site cannot share the same port with an HTTP site.  If an HTTPS site tries to share the port of an already configured HTTP site (listed first in <code class="highlighter-rouge">jscause.conf</code>), JSCause will emit an error and stop running.</p>
  </li>
  <li>
    <p>If two HTTPS sites share the same port, only the <code class="highlighter-rouge">httpsCertFile</code> and <code class="highlighter-rouge">httpsKeyFile</code> of the first site listed in <code class="highlighter-rouge">jscause.conf</code> will be taken into account to configure the SSL connection.</p>
  </li>
</ul>

<h2 id="jscvendor-jscause-vendor-directory">jscvendor: JSCause vendor directory</h2>

<p>In a typical installation workflow, all you need to get JSCause up and running is to download the zip file, unzip it and run it.  No need to run an <code class="highlighter-rouge">npm install</code> command, or generate some usually big <code class="highlighter-rouge">node_modules/</code> directory that requires maintaining.</p>

<p>Of course, if you prefer to install via <code class="highlighter-rouge">npm</code>, <a href="/download.html">you can still do so</a>.</p>

<h2 id="symbolic-links-in-configuration-and-websites">Symbolic links in configuration and websites</h2>

<p>JSCause allows the use of symbolic links (symlinks) in many circumstances.  This allows you to have more flexibility on where to place your configuration files, as well as your website’s files, be it in the same storage media, or a different one.</p>

<p>It is important to note that JSCause will be constrained to the rules of both of the operating system and the file system where the symlinks reside.</p>

<h3 id="where-symlinks-can-be-used">Where symlinks can be used</h3>

<p>Symlinks can be used in practically any scenario in which the underlying operating system (OS) allows them.  However, JSCause does extra checks (e.g. preemptively detecting circular references) in the following scenarios:</p>

<h4 id="jscauseconf-rootdirectoryname">jscause.conf: rootDirectoryName</h4>

<p>Your website’s root directory can be a symlink.</p>

<p>For example, let’s assume that the location of your site is in <code class="highlighter-rouge">/mnt/great_sites/a_great_site</code>, and your JSCause installation is in <code class="highlighter-rouge">/home/user_name/jscause</code>.  This would mean that the <code class="highlighter-rouge">sites</code> directory is in <code class="highlighter-rouge">/home/user_name/jscause/sites</code>.  You can create a symlink to <code class="highlighter-rouge">a_great_site</code> by issuing the following in the terminal:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ln -s /mnt/great_sites/a_great_site /home/user_name/jscause/sites/a_great_site_link
</code></pre></div></div>

<p>Then you can configure the root directory name as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"rootDirectoryName": "a_great_site_link"
</code></pre></div></div>

<h4 id="site-contents-files-and-directories">Site contents files and directories</h4>

<p>You can use symlinks in place of files and directories within your site’s <code class="highlighter-rouge">website</code> directory.  JSCause will treat them as if they were being called right on the symlink’s spot.</p>

<p>For example, let’s assume that your website uses a JSCP file located at <code class="highlighter-rouge">/mnt/great_sites/utlities/time.jscp</code>.  However, the actual website is located at <code class="highlighter-rouge">/home/user_name/jscause/sites/a_great_site/website/</code>.  You can create a symlink to <code class="highlighter-rouge">time.jscp</code> by issuing the following command in the terminal:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ln -s /mnt/great_sites/utlities/time.jscp /home/user_name/jscause/sites/a_great_site/website/time_link.jscp
</code></pre></div></div>

<p>Then, assuming your site’s domain name is <code class="highlighter-rouge">example.com</code>, you can refer to that file from a web browser by visiting: <code class="highlighter-rouge">http://example.com/time_link.jscp</code>.</p>

<p>Please note that we’re using a <code class="highlighter-rouge">_link</code> suffix here for demonstration purposes.  In reality, you can name the symlink any way you want.</p>

<h4 id="sitejson-tempworkdirectory">site.json: tempWorkDirectory</h4>

<p>You can use a symlink for your website’s temporary work directory.  For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ln -s /mnt/great_sites/one_great_site/workbench /home/user_name/jscause/sites/a_great_site/workbench_link
</code></pre></div></div>

<p><strong>Be mindful about where you place this directory.</strong>  It should be a location outside of your site’s <code class="highlighter-rouge">/website</code> directory.  It should never be public.</p>

<h4 id="logging-1">Logging</h4>

<p>You can use a symlink when specifying a logging directory, in both a server-wide scenario as well as a site-wide scenario.</p>

<p>Here are two examples:</p>

<p>In the case of server-wide logging, let’s assume that your logging directory is at <code class="highlighter-rouge">/mnt/all_server_logging/logging/</code>, and the JSCause installation is at <code class="highlighter-rouge">/home/user_name/jscause/</code>.  You can create a symlink to the logging directory by issuing the following command in the terminal:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ln -s /mnt/all_server_logging/logging /home/user_name/jscause/server_logs_link
</code></pre></div></div>

<p>Then on <code class="highlighter-rouge">jscause.conf</code>, you can configure the logging directory as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "general": {
      "directoryName": "./server_logs_link",
      // etc
    }
  }
</code></pre></div></div>

<p>A similar procedure can be done for site-wide configurations.  Let’s assume that your site’s logging directory is at <code class="highlighter-rouge">/mnt/all_sites_logging/my_site/logging</code>, and your site is at <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite</code>.  You can create a symlink to the logging directory by issuing the following command in the terminal:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ln -s /mnt/all_sites_logging/my_site/logging /home/user_name/jscause/sites/mysite/logs_link
</code></pre></div></div>

<p>Then on <code class="highlighter-rouge">site.json</code> you can configure the logging directory as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "logging": {
    "directoryName": "./logs_link",
    // etc
  }
</code></pre></div></div>

<h2 id="terminating-an-jscause-instance">Terminating an JSCause instance</h2>

<p>JSCause will gracefully terminate when the Ctrl+C keyboard combination is used in the terminal window it is running on.  Alternatively, you can send a SIGTERM or SIGNINT kill signal to JSCause’s process to do the same thing.</p>

<p>When JSCause is instructed to terminate, it will close the log files. If there are any log files being compressed at that very moment, it will wait until the operation completes.  Any pending log files to compress will be ignored after that.</p>

<p>If JSCause receives a second Ctrl+C keyboard combination during termination and cleanup, it will display the following message:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Still cleaning on exit.  Try again to exit right away...
</code></pre></div></div>

<p>At that point, if you press Ctrl+C again (a third time), JSCause will terminate immediately, interrupting any cleanup operation.  Avoid getting to this point as much as possible, since compressed log files being created at that point may be rendered unusable.</p>

<h2 id="the-rt-runtime-object-reference">The rt runtime object reference</h2>

<p>Here’s the complete list of methods and variables available in the <code class="highlighter-rouge">rt</code> object:</p>

<h3 id="rtadditional">rt.additional</h3>

<p><em>Type</em>: Object.</p>

<p>It contains additional values related to a previously run JSCause operation, or an error.</p>

<p>At the moment, the only value available is <code class="highlighter-rouge">rt.additional.jsonParseError</code>, which will be set to <code class="highlighter-rouge">true</code> if an incoming request includes a JSON-formatted payload, and JSCause was unable to parse it )(for instance, if it was malformed.)</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;js</span> <span class="na">if</span> <span class="err">(</span><span class="na">rt</span><span class="err">.</span><span class="na">additional</span><span class="err">.</span><span class="na">jsonParseError</span><span class="err">)</span> <span class="err">{</span>
      <span class="na">rt</span><span class="err">.</span><span class="na">print</span><span class="err">('</span><span class="na">Sorry</span><span class="err">,</span> <span class="na">the</span> <span class="na">upload</span> <span class="na">JSON</span> <span class="na">object</span> <span class="na">was</span> <span class="na">not</span> <span class="na">understood</span><span class="err">');</span>
    <span class="err">}</span>
<span class="err">/</span><span class="na">js</span><span class="nt">&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div></div>

<p>See also:</p>
<ul>
  <li><a href="#rtpostparams">rt.postParams</a></li>
</ul>

<h3 id="rtcontenttype">rt.contentType</h3>

<p><em>Type</em>: String.</p>

<p>It contains the content type of the request.  For example, <code class="highlighter-rouge">text/plain</code>.</p>

<p>Having said that, there are three cases which will set <code class="highlighter-rouge">contentType</code> to values unique to JSCause:</p>

<ul>
  <li><code class="highlighter-rouge">formData</code>: When the request contains a submitted HTML form.</li>
  <li><code class="highlighter-rouge">formDataWithUpload</code>:  When the request contains a submitted HTML form and/or uploaded files.</li>
  <li><code class="highlighter-rouge">jsonData</code>: When the request is submitted as JSON.</li>
</ul>

<p>See also:</p>
<ul>
  <li><a href="#rtpostparams">rt.postParams</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtrequestmethod">rt.requestMethod</a></li>
</ul>

<h3 id="rtcopyfile">rt.copyFile()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.copyFile(source:String, destination:String[, overwrite:Boolean = true])</code></p>

<p><em>Returns</em>: RT Promise.</p>

<p>It copies a file from <code class="highlighter-rouge">source</code> to <code class="highlighter-rouge">destination</code>.  <code class="highlighter-rouge">overwrite</code> is optional, and <code class="highlighter-rouge">true</code> by default.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.copyFile('my_file.txt', 'my_copied_file.txt')
  .rtOnSuccess(() =&gt; { rt.print('File copied successfully!'); })
  .rtOnError((err) =&gt; { rt.print(`There was an error: ${err}`); });
</code></pre></div></div>

<p><code class="highlighter-rouge">source</code> and <code class="highlighter-rouge">destination</code> can be either absolute or relative paths.</p>

<p>If a relative path, it will be relative to the site’s <code class="highlighter-rouge">rootDirectoryName</code>.  For example:  if JSCause is installed in <code class="highlighter-rouge">/home/user_name/jscause/</code>, <code class="highlighter-rouge">rootDirectoryName</code> is <code class="highlighter-rouge">mysite</code>, and <code class="highlighter-rouge">source</code> is <code class="highlighter-rouge">./folder/file.txt</code>, then the latter will be intepreted as <code class="highlighter-rouge">/home/user_name/jscause/sites/mysite/folder/file.txt</code>.</p>

<p>If <code class="highlighter-rouge">destination</code> exists prior to the copy operation, JSCause will check the value of <code class="highlighter-rouge">overwrite</code>.  If <code class="highlighter-rouge">overwrite</code> is <code class="highlighter-rouge">true</code>, then the copy operation will overwrite whatever is in <code class="highlighter-rouge">destination</code>.  If <code class="highlighter-rouge">overwrite</code> is <code class="highlighter-rouge">false</code>, then JSCause will <em>not</em> proceed with the copy operation, and will emit an <code class="highlighter-rouge">EEXISTS</code> error instead.</p>

<p><code class="highlighter-rouge">rt.copyFile</code> returns an RT Promise, which consists in two chainable methods, <code class="highlighter-rouge">rtOnSuccess()</code> and <code class="highlighter-rouge">rtOnError()</code>.  Only one of them will apply depending on whether the copy operation succeeds or fails.  When the copy operation succeeds, JSCause will invoke the callback specified by <code class="highlighter-rouge">rtOnSuccess()</code>.  If it fails, JSCause will invole the callback specified by <code class="highlighter-rouge">rtOnError()</code>.</p>

<p>This method relies on node’s <code class="highlighter-rouge">fs.copyFile</code>.  Any strengths and limitations of the latter will apply to <code class="highlighter-rouge">rt.copyFile</code> as well.</p>

<p>Notes:</p>

<ul>
  <li>
    <p>You will read elsewhere in this document that callbacks must be wrapped with <code class="highlighter-rouge">rt.waitFor()</code>.  When you use <code class="highlighter-rouge">rtOnSuccess()</code> and <code class="highlighter-rouge">rtOnError()</code>, no such wrapping is necessary.  You can <a href="#rt-promises">read more about RT Promises here</a>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">overwrite</code> is <code class="highlighter-rouge">false</code> and the destination exists, the error thrown, <code class="highlighter-rouge">err</code>, is not native.  JSCause will try to mimmick what <code class="highlighter-rouge">copyFile</code> does as much as possible.  The <code class="highlighter-rouge">errno</code> attribute won’t be available.  This is because the POSIX’s <code class="highlighter-rouge">rename</code> operation will always overwrite.  JSCause checks for file existence first, then acts accordingly.</p>
  </li>
</ul>

<p>See also:</p>
<ul>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtdeletefile">rt.deleteFile</a></li>
  <li><a href="#rtfileexists">rt.fileExists</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rt-promises">RT Promises</a></li>
</ul>

<h3 id="rtdeletecookie">rt.deleteCookie()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.deleteCookie(name:String)</code></p>

<p><em>Returns</em>: Boolean.</p>

<p>It deletes a browser cookie.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.deleteCookie('my_cookie');
</code></pre></div></div>

<p>If it succeeds, it will return <code class="highlighter-rouge">true</code>.  Otherwise, it will return <code class="highlighter-rouge">false</code>.</p>

<p>If <code class="highlighter-rouge">name</code> is not a string, <code class="highlighter-rouge">rt.deleteCookie</code> will return <code class="highlighter-rouge">false</code>.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtgetcookie">rt.getCookie</a></li>
  <li><a href="#rtsetcookie">rt.setCookie</a></li>
</ul>

<h3 id="rtdeletefile">rt.deleteFile()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.deleteFile(filePath:String)</code></p>

<p><em>Returns</em>: RT Promise.</p>

<p>It deletes a file specified by <code class="highlighter-rouge">filePath</code>.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.deleteFile('my_file.txt')
  .rtOnSuccess(() =&gt; { rt.print('File deleted successfully!'); })
  .rtOnError((err) =&gt; { rt.print(`There was an error: ${err}`); });
</code></pre></div></div>

<p><code class="highlighter-rouge">filePath</code> can be either absolute or relative.</p>

<p><code class="highlighter-rouge">rt.deleteFiles()</code> will not delete directories.</p>

<p>Please see the notes on <a href="#rtcopyfile">rt.copyFile()</a> for more information on file operations on relative paths, as well as the RT Promise type.</p>

<p>This method relies on node’s <code class="highlighter-rouge">fs.unlink</code>.  Any strengths and limitations of the latter will apply to <code class="highlighter-rouge">rt.deleteFile</code> as well.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtdeletefile">rt.copyFile</a></li>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtfileexists">rt.fileExists</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rt-promises">RT Promises</a></li>
</ul>

<h3 id="rtfileexists">rt.fileExists()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.fileExists(filePath:String)</code></p>

<p><em>Returns</em>: RT Promise.</p>

<p>It determined whether a file specified by <code class="highlighter-rouge">filePath</code> exists or not.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.fileExists('my_file.txt')
  .rtOnSuccess(() =&gt; { rt.print('File exists!'); })
  .rtOnError((err) =&gt; { rt.print((err === 'ENOENT') ? 'File does not exist' : `There was an error: ${err}`); });
</code></pre></div></div>

<p><code class="highlighter-rouge">filePath</code> can be either absolute or relative.</p>

<p>As seen from the example above, <code class="highlighter-rouge">rtOnSuccess</code> is called if file exists.  <code class="highlighter-rouge">rtOnError</code> will be called if file does not exist, but <em>also</em> if some other error happens.  Always check the error.  When the file does not exist, the error will be <code class="highlighter-rouge">ENOENT</code>.  Anything different from <code class="highlighter-rouge">ENOENT</code> should be addressed.</p>

<p>Please see the notes on <a href="#rtcopyfile">rt.copyFile()</a> for more information on file operations on relative paths, as well as the RT Promise type.</p>

<p>This method relies on node’s <code class="highlighter-rouge">fs.stat</code>.  Any strengths and limitations of the latter will apply to <code class="highlighter-rouge">rt.fileExists</code> as well.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtdeletefile">rt.copyFile</a></li>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtdeletefile">rt.deleteFile</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rt-promises">RT Promises</a></li>
</ul>

<h3 id="rtgetcookie">rt.getCookie()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.getCookie(name:String[, options:Object])</code></p>

<p><em>Returns</em>: String.</p>

<p>It reads the value of a browser cookie. <code class="highlighter-rouge">options</code> is optional, and it contains additional instructions to decode the cookie value before returning it.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const cookieValue1 = rt.getCookie('my_cookie');
const cookieValue2 = rt.getCookie('my_cookie', { decodeURIValue: false });
</code></pre></div></div>

<p><code class="highlighter-rouge">options</code> may contain the <code class="highlighter-rouge">decodeURIValue</code> attribute, which is <code class="highlighter-rouge">true</code> by default. When <code class="highlighter-rouge">true</code>, the cookie value is URI-decoded before being returned.</p>

<p>Example:</p>

<p>Let’s assume that the <code class="highlighter-rouge">my_cookie</code> cookie has a raw value of <code class="highlighter-rouge">a%3Db</code>. In an URI, <code class="highlighter-rouge">%3D</code> refers to the <code class="highlighter-rouge">=</code> character:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>console.log(rt.getCookie('my_cookie'));  // ---&gt; Returns: "a=b"
console.log(rt.getCookie('my_cookie'), { decodeURIValue: false }); // --&gt; Returns `a%3Db`.
</code></pre></div></div>

<p>If <code class="highlighter-rouge">name</code> is not a string, <code class="highlighter-rouge">rt.getCookie</code> will return an empty string.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtsetcookie">rt.setCookie</a></li>
  <li><a href="#rtdeletecookie">rt.deleteCookie</a></li>
</ul>

<h3 id="rtgetcurrentpath">rt.getCurrentPath()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.getCurrentPath()</code></p>

<p><em>Returns</em>: String.</p>

<p>It yields the client request’s path without the resource (file name) portion.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const currentPath = rt.getCurrentPath();
</code></pre></div></div>

<p>For example, if the request url is <code class="highlighter-rouge">/some/directory/hello.jscp</code>, rt.getCurrentPath() will return <code class="highlighter-rouge">'/some/directory'</code>.</p>

<h3 id="rtgetparams">rt.getParams</h3>

<p><em>Type</em>: Object.</p>

<p>This is an object containing the client request’s GET query parameters.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const name = rt.getParams['txt_name'];
</code></pre></div></div>

<p>For example, if the request’s url is <code class="highlighter-rouge">https://www.example.com/home?message=hello</code>, then <code class="highlighter-rouge">rt.getParams['message']</code> will contain <code class="highlighter-rouge">'hello'</code>.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtpostparams">rt.postParams</a></li>
</ul>

<h3 id="rtheader">rt.header()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.header(name:String, value:String)</code>; <code class="highlighter-rouge">rt.header(collection:Object)</code></p>

<p><em>Returns</em>: Nothing (<code class="highlighter-rouge">undefined</code>).</p>

<p>It sets a response’s HTTP header entry.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.header('Last-Modified', 'Fri, 20 Dec 2020 12:00:00 GMT');
</code></pre></div></div>

<p>You can set up multiple header entries if you provide an object as a parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  &lt;Header name 1&gt;: &lt;value 1&gt;,
  &lt;Header name 2&gt;: &lt;value 2&gt;,
  etc
}
</code></pre></div></div>

<p>For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.header({
  'Last-Modified': 'Fri, 20 Dec 2020 12:00:00 GMT',
  'Content-Language': 'en',
  'X-App-Greeting': 'hello!'
});
</code></pre></div></div>

<p>You can call <code class="highlighter-rouge">rt.header</code> as many times as needed.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtgetcookie">rt.getCookie</a></li>
  <li><a href="#rtsetcookie">rt.setCookie</a></li>
  <li><a href="#rtdeletecookie">rt.deleteCookie</a></li>
  <li><a href="#rtcontenttype">rt.contentType</a></li>
  <li><a href="#rtredirectto">rt.redirectTo</a></li>
  <li><a href="#rtresetredirectto">rt.resetRedirectTo</a></li>
  <li><a href="#rtrequestmethod">rt.requestMethod</a></li>
</ul>

<h3 id="rtmodule">rt.module()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.module(moduleName:String)</code></p>

<p><em>Returns</em>: Any value (typically an object or function.)</p>

<p>It imports a module.  It technically is syntactic sugar for: <code class="highlighter-rouge">require('./moduleName.jscm')</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const sumModule = rt.module('sum.jscm');
</code></pre></div></div>

<p><code class="highlighter-rouge">moduleName</code> may omit the file module’s <code class="highlighter-rouge">.jscm</code> extension.  Its path is relative to the website directory.  Absolute paths are not permitted.  Attempting to use an absolute path will log an error and cause <code class="highlighter-rouge">rt.module()</code> to return <code class="highlighter-rouge">null</code> (a future version may throw an HTTP error 500.)</p>

<p>See also:</p>
<ul>
  <li><a href="#jscause-modules-jscm-files">JSCause modules: JSCM files</a></li>
</ul>

<h3 id="rtmovefile">rt.moveFile()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.moveFile(source:String, destination:String[, overwrite:Boolean = true])</code></p>

<p><em>Returns</em>: RT Promise.</p>

<p>It moves a file from <code class="highlighter-rouge">source</code> to <code class="highlighter-rouge">destination</code>.  <code class="highlighter-rouge">overwrite</code> is optional, and <code class="highlighter-rouge">true</code> by default.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.moveFile('my_source.txt', 'my_destination.txt')
  .rtOnSuccess(() =&gt; { rt.print('File moved successfully!'); })
  .rtOnError((err) =&gt; { rt.print(`There was an error: ${err}`); });
</code></pre></div></div>

<p><code class="highlighter-rouge">source</code> and <code class="highlighter-rouge">destination</code> can be either absolute or relative paths.</p>

<p>Please see the notes on <a href="#rtcopyfile">rt.copyFile()</a> for more information on file operations on relative paths, as well as the RT Promise type, and overwrite errors.</p>

<p>This method relies on node’s <code class="highlighter-rouge">fs.rename</code>.  Any strengths and limitations of the latter will apply to <code class="highlighter-rouge">rt.rename</code> as well.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtcopyfile">rt.copyFile</a></li>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtdeletefile">rt.deleteFile</a></li>
  <li><a href="#rtfileexists">rt.fileExists</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rt-promises">RT Promises</a></li>
</ul>

<h3 id="rtpostparams">rt.postParams</h3>

<p><em>Type</em>: Object.</p>

<p>This is an object containing the client request’s POST form-encoded parameters or JSON parameters.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const name = rt.postParams['txt_name'];
</code></pre></div></div>

<p>For example, given the following form in a web browser:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;form method="post"&gt;
  Name: &lt;input type="text" name="txt_name" value="" /&gt;
  &lt;input type="submit" name="b_submit" value="Send" /&gt;
&lt;/form&gt;
</code></pre></div></div>

<p>If a user fills the “Name” field with “Mary,” then submits the form, then <code class="highlighter-rouge">rt.postParams['txt_name']</code> will contain <code class="highlighter-rouge">'Mary'</code>.</p>

<p>If the POST request has a mime type of <code class="highlighter-rouge">application/json</code>, <code class="highlighter-rouge">postParams</code> will contain the parsed JSON payload.  If for some reason the JSON payload cannot be parsed, <code class="highlighter-rouge">rt.addidional.jsonParseError</code> will be set to <code class="highlighter-rouge">true</code>.</p>

<p>For example, given a POST request with the following payload:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "some_data": ["a", "b", "c]
}
</code></pre></div></div>

<p>Then <code class="highlighter-rouge">postParams['some_data']</code> will contain the following array <code class="highlighter-rouge">['a', 'b', 'c']</code>.</p>

<p>If the request contains file uploads, they’ll be available via <a href="#rtuploadedfiles">rt.uploadedFiles</a>.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtgetparams">rt.getParams</a></li>
  <li><a href="#rtadditiona">rt.additional</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
</ul>

<h3 id="rtprint">rt.print()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.print(value:String)</code></p>

<p><em>Returns</em>: Undefined.</p>

<p>It prints to the response body.  A web browser will display <code class="highlighter-rouge">value</code> in the page it renders.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.print('Hello, world');
</code></pre></div></div>

<p>Use <code class="highlighter-rouge">rt.print</code> as many times as you need to render dynamic content to a page:</p>

<p>Another example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;h1&gt;&lt;js rt.print('Hello, ', rt.postParams['txt_name']); /js&gt;&lt;/h1&gt;
&lt;p&gt;&lt;js
rt.print(`The value of PI is: ${Math.PI}`);
/js&gt;&lt;/p&gt;
</code></pre></div></div>

<p><code class="highlighter-rouge">rt.print</code> will escape symbols such as ‘&lt;’ and ‘&gt;’ so that they can be safely printed as such (the web browser will not erroneously render them as part of an HTML tag.)
For instance, the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;js rt.print('&lt;b&gt;Hello&lt;/b&gt;'); /js&gt;
</code></pre></div></div>

<p>Will output <code class="highlighter-rouge">&amp;lt;b&amp;gt;Hello&amp;lt;b&amp;gt;</code>.  Instead of printing it as bold <b>Hello</b>, a web browser will literally display it as <code class="highlighter-rouge">&lt;b&gt;Hello&lt;/b&gt;</code>.</p>

<p>If you want to print without escaping, use <a href="#rtunsafeprint">rt.unsafePrint()</a> instead (but please be careful and know what you’re doing.)</p>

<p>List of escaped symbols:</p>
<ul>
  <li><code class="highlighter-rouge">&amp;</code> (ampersand): Escaped as <code class="highlighter-rouge">&amp;amp;</code>.</li>
  <li><code class="highlighter-rouge">&lt;</code> (less-than symbol): Escaped as <code class="highlighter-rouge">&amp;lt;</code>.</li>
  <li><code class="highlighter-rouge">&gt;</code> (greater-than symbol): Escaped as <code class="highlighter-rouge">&amp;gt;</code>.</li>
  <li><code class="highlighter-rouge">"</code> (double quotation mark): Escaped as <code class="highlighter-rouge">&amp;quot;</code>.</li>
  <li><code class="highlighter-rouge">\</code> (backslash): Escaped as <code class="highlighter-rouge">&amp;#39;</code>.</li>
  <li><code class="highlighter-rouge">/</code> (slash): Escaped as <code class="highlighter-rouge">&amp;#x2F;</code>.</li>
  <li>` (backtick): Escaped as <code class="highlighter-rouge">&amp;#x60;</code>.</li>
  <li><code class="highlighter-rouge">=</code> (equals sign): Escaped as <code class="highlighter-rouge">&amp;#x3D;</code>.</li>
</ul>

<p>See also:</p>
<ul>
  <li><a href="#rtunsafeprint">rt.unsafePrint</a></li>
</ul>

<h3 id="rtreadfile">rt.readFile()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.readFile(path:String, encoding:String)</code></p>

<p><em>Returns</em>: RT Promise.</p>

<p>It reads the contents of a file specified by <code class="highlighter-rouge">path</code>.  <code class="highlighter-rouge">encoding</code> is optional, and <code class="highlighter-rouge">null </code> by default.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.readFile('my_source.txt', 'utf-8')
  .rtOnSuccess((response) =&gt; { rt.print('File read successfully!'); console.log(response); })
  .rtOnError((err) =&gt; { rt.print(`There was an error: ${err}`); });
</code></pre></div></div>

<p><code class="highlighter-rouge">path</code> can be either absolute or relative.</p>

<p><code class="highlighter-rouge">encoding</code> indicates the file encoding (e.g. ‘utf-8’, usually good for text data).  If not specified, then raw bytes are assumed (good for binary files.)</p>

<p>Please see the notes on <a href="#rtcopyfile">rt.copyFile()</a> for more information on file operations on relative paths, as well as the RT Promise type, and overwrite errors.</p>

<p>This method relies on node’s <code class="highlighter-rouge">fs.readFile</code>.  Any strengths and limitations of the latter will apply to <code class="highlighter-rouge">rt.readFile</code> as well.</p>

<p>Notice that this version of JSCause will accept an <code class="highlighter-rouge">encoding</code> object that can be passed directly to <code class="highlighter-rouge">rt.readFile</code>.  This <em>will</em> change. Future versions of JSCause will only accept a string.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtcopyfile">rt.copyFile</a></li>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtdeletefile">rt.deleteFile</a></li>
  <li><a href="#rtfileexists">rt.fileExists</a></li>
  <li><a href="#rtuploadedfiles">rt.uploadedFiles</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rt-promises">RT Promises</a></li>
</ul>

<h3 id="rtredirectto">rt.redirectTo()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.redirectTo(redirectUrl:String[, delayInSeconds:Number])</code></p>

<p><em>Returns</em>: Undefined.</p>

<p>It instructs the web client to redirect to a different url via an HTTP 302 (Found) code.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.redirectTo('https://www.example.com', 5);
</code></pre></div></div>

<p>The redirection will happen after all the JSCP code is run.  This includes all pending callbacks, for example, from timers and file operations.</p>

<p><code class="highlighter-rouge">delayInSeconds</code> is optional, and will instruct the web client to wait that many seconds before performing the actual redirection.  This time is in addition to the time the JSCP code is run, as previously stated.  Its value must be a number.  Otherwise, it will be ignored.</p>

<p>JSCause sets an HTTP 302 (found) status code to perform the redirect.  It also typically sets the <code class="highlighter-rouge">Location</code> HTTP header.  If delayInSeconds is provided and is valid, the <code class="highlighter-rouge">Refresh</code> header will be used instead.  This is not a standard header, although most modern browsers support it.</p>

<p>If more than one <code class="highlighter-rouge">rt.redirectTo</code> call are made, only the last one will be taken into account.</p>

<p>The value of the <code class="highlighter-rouge">redirectUrl</code> parameter should be of the string type.  Numbers can be used, but they will be converted to strings.  Anything else will be converted to its <code class="highlighter-rouge">.toString()</code> equivalent.  For instance, objects will be assumed <code class="highlighter-rouge">"[object Object]"</code>, arrays will be converted to a string with its values comma-separated (e.g. <code class="highlighter-rouge">"[1,2,3]"</code>).  You most likely don’t want to do this, so make sure you pass a string.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtresetredirectto">rt.resetRedirectTo</a></li>
  <li><a href="#rtheader">rt.header</a></li>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#rtwaitfor">rt.waitFor</a></li>
  <li><a href="#redirection">Redirection</a></li>
</ul>

<h3 id="rtrequestmethod">rt.requestMethod</h3>

<p><em>Type</em>: String.</p>

<p>It contains the type of the HTTP request.  The supported values are <code class="highlighter-rouge">get</code> and <code class="highlighter-rouge">post</code>.</p>

<p>The HTTP requests PUT and DELETE are not supported.  Therefore, if a web client attempts to make a request with them, JSCause will return an HTTP (method not allowed) 405 error.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtcontenttype">rt.contentType</a></li>
</ul>

<h3 id="rtresetredirectto">rt.resetRedirectTo()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.resetRedirectTo()</code></p>

<p><em>Returns</em>: Undefined.</p>

<p>It instructs will cancel any redirections scheduled via <code class="highlighter-rouge">rt.redirectTo()</code>.  If there are no scheduled redirections, this method has no effect.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtredirectto">rt.redirectTo</a></li>
  <li><a href="#redirection">Redirection</a></li>
</ul>

<h3 id="rtrunafter">rt.runAfter()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.runAfter(callback:Function)</code></p>

<p><em>Returns</em>: Undefined.</p>

<p>It will enqueue the call to <code class="highlighter-rouge">callback</code> after all <code class="highlighter-rouge">rt.waitFor()</code> callbacks are run.  <code class="highlighter-rouge">rt.runAfter()</code> is especially useful for file operations.</p>

<p>Both implicit and explicit <code class="highlighter-rouge">rt.waitFor()</code> callbacks are taken into account before running <code class="highlighter-rouge">rt.runAfter()</code> code.  Most JSCause methods that expect a callback (e.g. <code class="highlighter-rouge">rt.readFile()</code>) imply a <code class="highlighter-rouge">rt.waitFor()</code> call.</p>

<p><code class="highlighter-rouge">rt.runAfter()</code> can be called more than once.  Each callback will be run sequentially (i.e., not concurrently) and in the order that were specified.</p>

<p><code class="highlighter-rouge">rt.waitFor()</code> can be used inside <code class="highlighter-rouge">rt.runAfter()</code> callbacks.  Because the former takes precedence, any enqueued <code class="highlighter-rouge">rt.runAfter()</code> callbacks will again wait until those new <code class="highlighter-rouge">rt.waitFor()</code> callbacks are run.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtwaitfor">rt.waitFor</a></li>
  <li><a href="#callbacks">Callbacks</a></li>
</ul>

<h3 id="rtsetcookie">rt.setCookie()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.setCookie(name:String, value:String[, options:Object])</code></p>

<p><em>Returns</em>: String.</p>

<p>It sets the value of a browser cookie. <code class="highlighter-rouge">options</code> is optional, and it contains additional instructions to create or update the cookie.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const cookieValue1 = rt.setCookie('my_cookie');
const cookieValue2 = rt.getCookie('my_cookie', { path: '/' });
</code></pre></div></div>

<p><code class="highlighter-rouge">options</code> can be:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">domain</code></p>

    <p>e.g. <code class="highlighter-rouge">domain: 'example.com'</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">encodeURIValue</code></p>

    <p>Optional. If <code class="highlighter-rouge">true</code>, then <code class="highlighter-rouge">value</code> will be URI-encoded.</p>

    <p>Default: <code class="highlighter-rouge">true</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">expires</code></p>

    <p>e.g. <code class="highlighter-rouge">expires: new Date(Date.now() + 300000)</code>.</p>

    <p>If omitted, the cookie will last as long as the current browser session lasts).  If a value is passed, it must be a date object; otherwise a runtime exception will be thrown.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">httpOnly</code></p>

    <p>Optional. Boolean or equivalent truthy/falsy value.</p>

    <p>e.g. <code class="highlighter-rouge">httpOnly: true</code>.</p>

    <p>Default: <code class="highlighter-rouge">true</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">maxAge</code></p>

    <p>Expiration in milliseconds from date of creation. This attribute is recommended over <code class="highlighter-rouge">expires</code>.  If <code class="highlighter-rouge">maxAge</code> is not a number, it will be ignored.  And if both <code class="highlighter-rouge">expires</code> and a valid <code class="highlighter-rouge">maxAge</code> are present, <code class="highlighter-rouge">expires</code> will be ignored.</p>

    <p>e.g. <code class="highlighter-rouge">maxAge: 300000</code> (in milliseconds.)</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">path</code></p>

    <p>e.g. <code class="highlighter-rouge">path: '/example_path'</code></p>

    <p>Default: <code class="highlighter-rouge">/</code>.</p>

    <p>Use <code class="highlighter-rouge">rt.getCurrentPath()</code> if you want to set the cookie for the request’s (current) path (e.g. <code class="highlighter-rouge">my_folder/</code>).  Use <code class="highlighter-rouge">null</code> if you want to omit setting up a path completely.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">sameSite</code></p>

    <p>Optional.  However, if provided, it must be either <code class="highlighter-rouge">lax</code> or <code class="highlighter-rouge">strict</code>.</p>

    <p>e.g. <code class="highlighter-rouge">sameSite: "lax"</code>.</p>

    <p>Any value other than <code class="highlighter-rouge">"lax"</code> or <code class="highlighter-rouge">"strict"</code> will throw an exception.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">secure</code></p>

    <p>Optional. Boolean or equivalent truthy/falsy value.</p>

    <p>e.g. <code class="highlighter-rouge">secure: true</code>.</p>

    <p>An exception will be thrown if <code class="highlighter-rouge">secure</code> is <code class="highlighter-rouge">true</code> in non-HTTPS request.</p>
  </li>
</ul>

<p>The values of the <code class="highlighter-rouge">value</code> parameter, as well as those of the <code class="highlighter-rouge">domain</code> and <code class="highlighter-rouge">path</code> attributes of <code class="highlighter-rouge">option</code>, should be of the string type.  Numbers can be used, but they will be converted to strings.  Anything else will be converted to its <code class="highlighter-rouge">.toString()</code> equivalent.  For instance, objects will be assumed <code class="highlighter-rouge">"[object Object]"</code>, arrays will be converted to a string with its values comma-separated (e.g. <code class="highlighter-rouge">"[1,2,3]"</code>).</p>

<p>If <code class="highlighter-rouge">name</code> is not a string, <code class="highlighter-rouge">rt.setCookie</code> will return <code class="highlighter-rouge">false</code>.</p>

<p>To handle unexpected scenarios which could potentially throw exceptions (and therefore send an error 500 status code to the browser), <code class="highlighter-rouge">rt.setCookie()</code> could be wrapped in a <code class="highlighter-rouge">try/catch</code> block. If you do this, always check for exceptions and handle accordingly.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtgetcookie">rt.getCookie</a></li>
  <li><a href="#rtdeletecookie">rt.deleteCookie</a></li>
</ul>

<h3 id="rtunsafeprint">rt.unsafePrint()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.unsafePrint(value:String)</code></p>

<p><em>Returns</em>: Undefined.</p>

<p>It prints to the response body.  A web browser will display <code class="highlighter-rouge">value</code> in the page it renders.</p>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.unsafePrint('Hello, world');
</code></pre></div></div>

<p>Use <code class="highlighter-rouge">rt.unsafePrint</code> as many times as you need to render dynamic content to a page.</p>

<p>Unlike <code class="highlighter-rouge">rt.print</code>, <code class="highlighter-rouge">rt.unsafePrint</code> will not escape <code class="highlighter-rouge">value</code>, or alter it in any way.</p>

<p>Be sure to know all the risks, and that you know what you are doing when using this method.  Be cautious; avoid XSS attacks; never trust data coming from outside, like user input! If you need to print content that could be deemed unsafe, or expose your application to vulnerabilities (e.g. to print back user input), use <code class="highlighter-rouge">rt.print</code> instead.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtprint">rt.print</a></li>
</ul>

<h3 id="rtuploadedfiles">rt.uploadedFiles</h3>

<p><em>Type</em>: Object.</p>

<p>This is an object containing the client request’s POST multipart form-encoded file uploads.</p>

<p>Each form file element’s name is represented as a key is <code class="highlighter-rouge">rt.uploadedFiles</code>.</p>

<p>For example, given the following form:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;form method="post" enctype="multipart/form-data"&gt;
  &lt;input name="myFile" type="file" value="" /&gt;
  &lt;input type="submit" name="uploadIt" value="Upload" /&gt;
&lt;/form&gt;
</code></pre></div></div>

<p>The uploaded file would be available via <code class="highlighter-rouge">rt.uploadedFiles['myFile']</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rt.print(`The uploaded file's name is: ${rt.uploadedFiles['myFile']}`);
</code></pre></div></div>

<p>Each value in <code class="highlighter-rouge">rt.uploadedFiles</code> is either an object containing the file’s information, or an array of files, if the form accepts multiple files per field.</p>

<p>Examples:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  const oneFileName = rt.uploadedFiles['myFile'].name;
  const anotherFileName = rt.uploadedFiles['multipleFileField'][0].name;
  const yetAnotherFileName = rt.uploadedFiles['multipleFileField'][1].name;
</code></pre></div></div>

<p>A file object contains:</p>

<ul>
  <li><code class="highlighter-rouge">name</code>:  The file’s name.  The name has been sanitized to avoid common XSS attacks.  The sanitization is based on the <code class="highlighter-rouge">sanitize-filename</code> NPM package.</li>
  <li><code class="highlighter-rouge">unsafeName</code>:  The file’s name without sanitization.  Use with caution.</li>
  <li><code class="highlighter-rouge">path</code>:  The file’s location in the filesystem after it has been uploaded.  This path is temporary (see below.)</li>
  <li><code class="highlighter-rouge">size</code>:  The file’s size in bytes.</li>
  <li><code class="highlighter-rouge">type</code>:  The file’s MIME type.</li>
  <li><code class="highlighter-rouge">lastModifiedDate</code>:  the file’s last modified date in the form of a Date object.</li>
</ul>

<p>The file’s <code class="highlighter-rouge">path</code> refers to a temporary location (specified by the <code class="highlighter-rouge">tempWorkDirectory</code> configuration value) and random file name (assigned by JSCause).  This random file name differs from the file name specified by the client during uploading, and thus is different from <code class="highlighter-rouge">.name</code> and <code class="highlighter-rouge">.unsafeName</code>.</p>

<p>If the application needs to preserve the uploaded files, it must either move it or copy to a different location.  Once the script is done (and all the <code class="highlighter-rouge">rt.waitFor()</code> callbacks completed), the files will be deleted from their temporary location.  The most performant way to preserve the files would be to move them asynchronously (in combination with <code class="highlighter-rouge">rt.waitFor()</code>, if needed.)</p>

<p>See also:</p>
<ul>
  <li><a href="#rtreadfile">rt.readFile</a></li>
  <li><a href="#rtmovefile">rt.moveFile</a></li>
  <li><a href="#rtcopyfile">rt.copyFile</a></li>
  <li><a href="#rtpostparams">rt.postParams</a></li>
  <li><a href="#rtrequestmethod">rt.requestMethod</a></li>
  <li><a href="#rtcontenttype">rt.contentType</a></li>
</ul>

<h3 id="rtwaitfor">rt.waitFor()</h3>

<p><em>Type</em>: Method.</p>

<p><em>Syntax</em>: <code class="highlighter-rouge">rt.waitFor(callback:Function)</code></p>

<p><em>Returns</em>: A callback function.</p>

<p>It will signal JSCause that it must wait for <code class="highlighter-rouge">callback</code> to complete before sending a response back to the web client.  <code class="highlighter-rouge">rt.waitFor()</code> must usually be used in any circumstance in which a callback is expected.  For example, with <code class="highlighter-rouge">setTimeout()</code>.</p>

<p>Example:</p>

<p>Instead of doing this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  setTimeout(() =&gt; { console.log('Send response after 2 seconds.'); }, 2000);
</code></pre></div></div>

<p>Do:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  setTimeout(rt.waitFor(() =&gt; { console.log('Send response after 2 seconds.'); }), 2000);
</code></pre></div></div>

<p>If a callback is not enclosed with <code class="highlighter-rouge">rt.waitFor()</code>, JSCause will not wait for it to complete, which may be undesirable if its operation is needed to return a correct response back to the web client.</p>

<p><code class="highlighter-rouge">rt.waitFor()</code> will correctly rely the arguments it receives to its callback parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // Assuming that someAsyncOperation() requires a callback handling a "response" parameter.
  someAsyncOperation(rt.waitFor((response) =&gt; { console.log(`The response is: ${response}`); }));
</code></pre></div></div>

<p><code class="highlighter-rouge">rt.waitFor()</code> can be nested.  For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  setTimeout(rt.waitFor(() =&gt; {
    console.log('2 seconds have passed.  Let\'s wait for 2 more seconds.');
    setTimeout(rt.waitFor(() =&gt; {
      console.log('Send response after 4 seconds.');
    }), 2000);
  }), 2000);
</code></pre></div></div>

<p><code class="highlighter-rouge">rt</code> methods expecting a callback, such as file operations, must not use <code class="highlighter-rouge">rt.waitFor()</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// This is incorrect:
rt.readFile('my_source.txt', 'utf-8')
  .rtOnSuccess(rt.waitFor(() =&gt; { rt.print('File read successfully!'); }));

// This is correct:
rt.readFile('my_source.txt', 'utf-8')
  .rtOnSuccess(() =&gt; { rt.print('File read successfully!'); });
</code></pre></div></div>

<p>If a runtime exception happens while a callback is still pending, JSCause will wait until the blocking operation completes.  When it does, it won’t execute the code inside the callback:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  const timeInSeconds = 10;
  setTimeout(() =&gt; {
    console.log('JSCause will wait ${timeInSeconds} seconds for the setTimeout() to complete.');
    console.log('However, if a runtime error happened in that period, these two console outputs will never occur');
  }, timeInSeconds * 1000);
</code></pre></div></div>

<p>Remember that the <a href="#requesttimeoutsecs"><code class="highlighter-rouge">requestTimeoutSecs</code></a> (<code class="highlighter-rouge">requesttimeoutsecs</code>) server config value dictates how many seconds the JSCause will wait for a request to complete.</p>

<p>See also:</p>
<ul>
  <li><a href="#rtrunafter">rt.runAfter</a></li>
  <li><a href="#requesttimeoutsecs">requestTimeoutSecs</a></li>
  <li><a href="#callbacks">Callbacks</a></li>
</ul>

<h2 id="faq-and-troubleshooting-jscause">FAQ and Troubleshooting JSCause</h2>

<h3 id="why-doesnt-jscause-complain-when-a-certificate-or-key-file-is-invalid">Why doesn’t JSCause complain when a certificate or key file is invalid?</h3>

<p>You may have configured the site as HTTP, not HTTPS.  When the site is configured as HTTP, JSCause will ignore these files.</p>

<p>If the site is indeed HTTPS, then another reason could be that it’s sharing the port with another, correctly configured HTTPS site.  In this case, the browser will alert the end users about the misconfiguration.</p>

<h3 id="sitejson-accepts-a-hostname-that-could-already-be-used-in-another-sites-sitejson--is-this-a-bug"><code class="highlighter-rouge">site.json</code> accepts a hostName that could already be used in another site’s site.json.  Is this a bug?</h3>

<p>This is fine as long as both sites use different ports.</p>

<h3 id="jscause-says-a-file-does-not-exist-but-i-can-see-it-in-the-file-system">JSCause says a file does not exist, but I can see it in the file system</h3>

<p>It may be a broken symlink that doesn’t point to a valid file anymore.</p>

<h2 id="list-of-errors-and-warnings-reported-by-jscause">List of errors and warnings reported by JSCause</h2>

<p>Here is a list of errors and warnings that JSCause may report in the logs, or directly in the terminal.  This list is not completely exhaustive.  It may not include errors that are fairly easy to fix (e.g. “Missing rootDirectoryName”) or that could only show up during internal testing.</p>

<p>(TO-DO:)
$$ Syntax warnings:</p>

<p>warning: Site: &lt;html/&gt; keyword found in the middle of code.  Did you mean to put it in the beginning of an HTML section?</p>

<p>$$ Configuration warnings:</p>

<p>warning: Site configuration: <mime type=""> mimetype value is empty.  Assumed application/octet-stream.
warning: Site configuration: Site <site name=""> has <file or="" console=""> logging &lt;enabled | disabled&gt; while the server has per-site file logging &lt;disabled | enabled&gt;. - Server configuration prevails.
warning: Site configuration: Site <site name=""> is HTTPS, and would be sharing HTTPS port <port> with <site name="">
warning: Site configuration: Site <site name=""> is using <HTTP or="" HTTPS=""> in an already assigned HTTPS port, <port>
warning: Site configuration: Site <site name=""> is HTTP, and is sharing HTTPS port <port> with <site name=""></site></port></site></port></HTTP></site></site></port></site></file></site></mime></p>

<p>$$ Website layout warnings:</p>

<p>warning: Site <site name="">: &lt;error4xx/error5xx file&gt; detected in <path> subdirectory. Only error files in the root directory will be used to display custom errors.
warning: Could not delete unhandled uploaded file: <file name=""> (CONT) On the file system as: <path></path></file></path></site></p>

<p>$$ Configuration files:</p>

<p>error: Invalid <file name=""> file format. :: The file is not valid JscJSON (JSON with comments allowed.)
error: Error parsing <file name=""> Duplicate key: <key name="">
error: Error parsing <file name=""> <error description=""> :: Expected colons, commas, opening or closing brackets, etc, in JscJSON.
error: "<name>" is not a valid configuration key.  Check that all the keys and values in <file name=""> are valid. :: Make sure that all the keys in your configuration files are valid.  For example, `jscause.conf` will accept the `sites`, `logging` and `requestTimeoutSecs` keys.  Check that there are no typos, e.g. `sitess` instead of `sites`, and that all the keys are known to JSCause (e.g. `cheeseTacos` may trigger this error.)
error: <configuration name="">:  The following configuration attribute was not found: - <key name=""> :: Check that the required key specified by <key name=""> is present in the filename specified by <configuration name="">. For instance, if the `sites` global configuration key is missing from `jscause.conf`, JSCause will show this error.</configuration></key></key></configuration></file></name></error></file></key></file></file></p>

<p>$$ Directories:</p>

<p>error: Temporary work directory path <path> must be specified as relative to <site name="">.</site></path></p>

<p>$$ Forms and uploads:</p>

<p>error: Could not rename unhandled uploaded file: <file name=""> (CONT) Renaming from: <old path=""> (CONT) Renaming to: <new path=""> :: Occurs right after uploading.  Read only directory? Disk full? Disk became unavailable?
error: Site: <name>: Application error when processing <file name="">. :: Happend if an errors occurs when deleting unhandled uploaded files.
error: Form upload related error. :: An error ocurred while receiving the contents of an HTML form.  Usually this error is followed by more details about it, for example, an interrupted connection.</file></name></new></old></file></p>

<p>$$ Runtime errors:</p>

<p>error: Site: <name>: Runtime error on file <file name="">: <error description="">
error: Site <site name="">: Cannot serve <path> file. :: The static file was deleted/unavailable after JSCause was launched.</path></site></error></file></name></p>

<p>$$ Module errors:</p>

<p>error: Module name and path <module path=""> must be specified as relative.</module></p>

<p>$$ Request errors:</p>

<p>error: Request related error. :: An error occured while receiving or processing the request.  Usually this error is followed by more details about it, for example, an interrupted connection.</p>

<p>$$ Startup errors:</p>

<p>error: Server <name> could not start listening on port <port>. - Error returned by the server follows: - Server <name> (port: <port>) not started. - Site <site name=""> not started. :: This error usually occurs when the port JSCause is trying to listen on is busy or unavailable (EADDRINUSE).  Another program may already be listening on that port.  If this is not the error displayed, JSCause will provide more information.
error: Site <site name="">: An error occurred while attempting to start HTTP server.
$ or:
error: Site <site name="">: An error occurred while attempting to start HTTPS server. :: It is rare when this error occurs, especially since other errors will be emitted for similar causes.  JSCause will provide more information at the time this error occurs.  Probable causes are, the port is already in use, or there is not enough memory to run JSCause. 
error: Cannot find <name> file. :: JSCause cannot find a configuration file, typically `jscause.conf` or one of the `site.json` files.  If `jscause.conf` can't be found, make sure it is in the same directory as the JSCause executable, `jscause.js`.  If a `site.json` file can't be found, make sure it is inside the `configuration` subdirectory of your website's directory.  [Read more in the site.json section](#sitejson-configuring-your-websites-details).
error: <name> is a directory. :: JSCause is either trying to read a configuration file, such as `jscause.conf` or `site.json`, but the name refers to a directory instead.  Make sure that `jscause.conf` and every `site.json` file is actually a file and not a directory.
error: Cannot load <name> file. :: JSCause attempted to read an existing configuration file, such as `jscause.conf` or `site.json`, and was unable to do so.  Make sure that JSCause has all the necessary access and permissions to read these files.
error: Site: Compile error: <error> :: JSCause could not compile your program.  It's possibly due to a syntax error.  JSCause will try to display as much information about the error as possible.
error: Site: Parsing error, possibly internal. :: JSCause may contain a bug.  If you get this error, [please let us know](#more-resources).</error></name></name></name></site></site></site></port></name></port></name></p>

<p>$$ SSL-related errors:</p>

<p>error: Site <site name="">: Cannot read '<file name="">' SSL key file. :: The SSL key file provided is missing or not found in the directory JSCause was expecting.  Refer to the `httpsKeyFile` sub-section of [the site.json section](#sitejson-configuring-your-websites-details) for more information.
error: Site <site name="">: Cannot read '<file name="">' SSL cert file. :: The SSL cert file provided is missing or not found in the directory JSCause was expecting.  Refer to the `httpscertfile` sub-section of [the site.json section](#sitejson-configuring-your-websites-details) for more information.</file></site></file></site></p>

<p>===</p>

<p>error: Site: Cannot find source file: <path>
error: Site: Entry point is a directory: <path>
error: Site: Cannot load source file: <path>
error: Site: Could not compile code for <path>.
error: Site configuration: Site name <site name=""> is missing rootdirectoryname.
error: Site configuration: Site name <site name="">: rootdirectoryname cannot be empty.
error: Site configuration: Site name <site name="">: rootdirectoryname expects a string value.
error: Site configuration:  hostname cannot be empty.
error: Site configuration:  Invalid maxpayloadsizebytes.  Integer number expected.
error: Site configuration:  mimetype has an invalid '<value name="">' name.  Expected: <allowed names="">.
error: Site configuration:  mimetype has an invalid 'include' attribute value. Object (key, value) expected.
error: Site configuration:  mimetype has an invalid 'exclude' attribute value. Array expected.
error: Site configuration:  mimetype has an invalid <value name=""> value for <mime type="">.  String expected.
error: Site configuration:  mimetype name cannot be empty.
error: Site configuration:  mimetype has an invalid <value name=""> name.  String expected.
error: Site configuration:  tempworkdirectory cannot be empty.
error: Site configuration:  Invalid jscpextensionrequired value.  Use 'never' (recommended), 'optional' or 'always'.
error: Site configuration:  jscpextensionrequired cannot be empty.  Use 'never' (recommended), 'optional' or 'always'.
error: Site configuration:  Invalid httppoweredbyheader value.  Use 'include' or 'exclude'.
error: Site configuration:  httppoweredbyheader cannot be empty.  Use 'include' or 'exclude'.
error: Site configuration:  httpscertfile cannot be empty.
error: Site configuration:  httpskeyfile cannot be empty.
error: Site <site name="">: Cannot find link: - <path> --&gt; <linkedFileName>
error: Site <site name="">: Circular symbolic link reference: - <symlinkPath>
error: Site <site name="">: Too many files and/or directories (&gt; 2048) in directory (circular reference?): - <path>
error: Too many processed so far (&gt; 4096) (circular reference?): - <path>
error: Too many directories left to process (&gt; 1024) (circular reference?): - <path>
error: Site <site name="">: Too many files and/or directories (&gt; 2048) in directory: - <path>
error: Site <site name="">: Too many files and/or directories (&gt; 2048) in directory: - <path>
error: Cannot find directory: <name>
error: Cannot find link: - <name> --&gt; <path>
error: <name> --&gt; <path> is not a directory.
error: <name> --&gt; <path> is not writeable.
error: Configuration:  sites cannot be empty.
error: Configuration: logging: <key name="">: <key name=""> is not a valid configuration key.
error: Configuration: logging:  Invalid value for general.  Object expected.
error: Configuration: logging:  <key name=""> is not a valid configuration key.
error: Server configuration:  Expected a valid logging configuration value.
error: Site configuration: Logging: '<key name="">' is not a valid configuration key.
error: Site configuration: Logging: 'perSite' section must not have a 'directoryName' configuration key.
error: Site configuration: Logging: 'perSite' section must not have a 'logfilesizethreshold' configuration key.
error: Site configuration: Logging: 'logfilesizethreshold' must be 0 or greater.
error: Site configuration: Logging: 'logfilesizethreshold' is invalid.  Integer number expected.
error: Site configuration: '<name>' site logging: 'perSite' section must not have a 'logfilesizethreshold' configuration key.
error: Site configuration: '<name>' site logging: Invalid directoryname.  String expected.
error: Site configuration: '<name>' site logging: directoryname must be a relative path.
error: Site configuration: '<name>' site logging: directoryname is missing.
error: Site configuration: '<name>' site logging: directoryname cannot be empty.
error: Site configuration: Logging: fileoutput must be either 'enabled' or 'disabled'.
error: Site configuration: Logging: consoleOutput must be either 'enabled' or 'disabled'.
error: Site configuration: Site <site name="">: logging directoryname cannot be empty.
error: Site configuration: Site name '<name>' is not unique.
error: Site configuration: Site name has an invalid value, <name>. String expected.
error: Site configuration: Missing name.
error: Site configuration:  Site name <site name=""> has an invalid port.  Integer number expected.
error: Site configuration: Site name <site name=""> is missing port.
error: Site configuration: <site name="">: Site root directory name <directory name=""> cannot be specified as an absolute path.  Directory name expected.
error: Site configuration: Site name <site name=""> has an invalid 'enablehttps' value.  Boolean expected.
error: Site configuration: Site <site name="">: site.json is invalid.
error: Site configuration: Both sites &lt;site name 1&gt; and &lt;site name 2&gt; have the same root directory and port combination - '<path>', <port>
error: Site configuration: <site name=""> is attempting to use an already existing root directory and port combination - '<path>', <port>
error: Site configuration: Site <site name=""> is HTTPS, and would be sharing HTTP port <port> with <site name="">
error: Site configuration: Site <site name=""> is attempting to use HTTPS in an already assigned HTTP port, <port>
error: Site configuration: Both sites &lt;site name 1&gt; and &lt;site name 2&gt; have the same host name and port combination - '<host name="">', <port>
error: Site configuration: <site name="">, <port> is already in use
error: Site <site name="">: Too many files and/or directories (&gt; 2048) in directory: - <path>
error: Site <site name="">: could not read directory: <path>
error: Site <site name="">: Cannot find <path>
error: Site configuration: invalid or missing rootDirectoryName.
error: Site <site name=""> not started.
error: Site <site name=""> not started.
error: The following sites failed to run: - <site names="">
error: Server not started.  No sites are running.</site></site></site></path></site></path></site></path></site></port></site></port></host></port></site></site></port></site></port></path></site></port></path></site></site></directory></site></site></site></name></name></site></name></name></name></name></name></key></key></key></key></path></name></path></name></path></name></name></path></site></path></site></path></path></path></site></symlinkPath></site></linkedFileName></path></site></value></mime></value></allowed></value></site></site></site></path></path></path></path></p>

<p>HTTP errors:</p>

<p>HTTP error 413: Payload exceeded limit of <amount> bytes
HTTP error 408: Timeout exceeded limit of <amount> seconds
HTTP error 403: Uploading is forbidden</amount></amount></p>

<p>Non-logged errors and warnings (terminal only):</p>

<p>Unrecognized command line switch. Server not started.
ERROR:  Error on server listening termination:
WARNING! Log message queue full.  No entries are being logged to file.  Check permissions, storage space and/or filesystem health.
WARNING!  Reached the amount of log termination retries due to pending callbacks (30).  Giving up.</p>

<p>Critical errors:</p>

<p>error: CRITICAL: An application error occurred when processing an incoming request.
error: CRITICAL: One or more vendor modules did not load.  JSCause will now terminate.
error: CRITICAL: An application error occurred when processing a callback.
error: CRITICAL: Cannot load <vendor file="" name=""> file. The JSCause installation might be corrupted.
error: CRITICAL: Cannot load <file name=""> file. The JSCause installation might be corrupted.
error: CRITICAL: Could not compile vendor module <name>.
error: CRITICAL: Failed to load vendor module <name>. The JSCause installation might be corrupted.</name></name></file></vendor></p>

<h2 id="more-resources">More resources</h2>

<p>(TO-DO:)
Where to find more information about JSCause?</p>

<h2 id="credits">Credits</h2>

<p>(TO-DO:)
Give credit here.</p>
<ul>
  <li>Thanks to:
    <ul>
      <li>https://github.com/felixge/node-formidable</li>
      <li>https://github.com/parshap/node-sanitize-filename</li>
      <li>https://github.com/pillarjs/cookies
Any others?</li>
    </ul>
  </li>
</ul>

<p>(TO-DO:)  Any references to the almost-JSON we use here should be called JscJSON (JSON with comments.)</p>

      </div>
      <div class="topmenu">
        <ul>
    
      
        <li><a href="index.html">Main</a></li>
      
    
      
        <li><a href="features.html">Features</a></li>
      
    
      
        <li><a href="download.html">Download</a></li>
      
    
      
        <li><a href="install.html">Installation</a></li>
      
    
      
        <li><a href="tutorial.html">Tutorial</a></li>
      
    
      
        <li>Documentation</li>
      
    
      
        <li><a href="faq.html">Frequently Asked Questions</a></li>
      
    
      
        <li><a href="about.html">About</a></li>
      
    
</ul>

      </div>
      <footer>
          &copy; 2020 EighthJouster
      </footer>
  </body>
</html>
